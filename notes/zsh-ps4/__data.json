{"type":"data","nodes":[null,{"type":"data","data":[{"entity":1},{"name":2,"nameSegmented":3,"kind":13,"urlPath":14,"historyURL":15,"lastModified":16,"attributes":17,"tags":19,"body":20,"headline":21,"links":22,"isEmpty":25},"シェルスクリプトで `set -x` して実行するコマンドを都度表示するとき、実行時刻も表示できる",[4,5,6,7,8,9,10,11,12],"シェルスクリプトで"," `set -x` して","実行する","コマンドを","都度","表示する","とき、","実行時刻も","表示できる","note","/notes/zsh-ps4","https://github.com/kissge/yo.eki.do/commits/master/notes/zsh-ps4.md",["Date","2024-05-01T11:44:01.000Z"],{"title":2,"date":18},["Date","2024-05-01T11:35:12.000Z"],[],"\u003Cp>シェルスクリプトを書くとき、 \u003Ccode>set -x\u003C/code> することで実行されるコマンドを都度表示できるのはよく知られている（？）。\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">\u003Cspan class=\"hljs-built_in\">set\u003C/span> -x\n\n\u003Cspan class=\"hljs-built_in\">date\u003C/span>\n\u003Cspan class=\"hljs-built_in\">sleep\u003C/span> 1\n\u003Cspan class=\"hljs-built_in\">date\u003C/span>\n\u003C/code>\u003C/pre>\n\u003Cpre>\u003Ccode class=\"language-sh\">$ bash test.sh\n+ \u003Cspan class=\"hljs-built_in\">date\u003C/span>\nWed May  1 08:32:59 PM JST 2024\n+ \u003Cspan class=\"hljs-built_in\">sleep\u003C/span> 1\n+ \u003Cspan class=\"hljs-built_in\">date\u003C/span>\nWed May  1 08:33:00 PM JST 2024\n\u003C/code>\u003C/pre>\n\u003Cp>実はzshでは、実行時刻も表示させることができる。\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">PS4=\u003Cspan class=\"hljs-string\">&#x27;[%*] + &#x27;\u003C/span>\n\u003Cspan class=\"hljs-built_in\">set\u003C/span> -x\n\n\u003Cspan class=\"hljs-built_in\">date\u003C/span>\n\u003Cspan class=\"hljs-built_in\">sleep\u003C/span> 1\n\u003Cspan class=\"hljs-built_in\">date\u003C/span>\n\u003C/code>\u003C/pre>\n\u003Cpre>\u003Ccode class=\"language-sh\">$ zsh test.sh\n[20:34:13] + \u003Cspan class=\"hljs-built_in\">date\u003C/span>\nWed May  1 08:34:13 PM JST 2024\n[20:34:13] + \u003Cspan class=\"hljs-built_in\">sleep\u003C/span> 1\n[20:34:14] + \u003Cspan class=\"hljs-built_in\">date\u003C/span>\nWed May  1 08:34:14 PM JST 2024\n\u003C/code>\u003C/pre>\n\u003Cp>要するにプロンプトを自由に設定できるというわけ。\u003C/p>\n\u003Cp>ちなみに、\u003Ca href=\"https://linux.die.net/man/1/zshparam#:~:text=PS4%20%3CS%3E,is%20%27%2B%20%27.\">\u003Ccode>man 1 zshparam\u003C/code>\u003C/a> に \u003Ccode>PS4\u003C/code> の説明があって、\u003C/p>\n\u003Cblockquote>\n\u003Cp>\u003Cstrong>PS4 &lt;S&gt;\u003C/strong>\u003C/p>\n\u003Cp>The execution trace prompt. Default is ‘+%N:%i&gt; ‘, which displays the name of the current shell structure and the line number within it. In sh or ksh emulation, the default is ‘+ ‘.\u003C/p>\n\u003C/blockquote>\n\u003Cp>\u003Ca href=\"https://linux.die.net/man/1/zshmisc#:~:text=%25*,format%2C%20with%20seconds.\">\u003Ccode>man 1 zshmisc\u003C/code> の「Simple Prompt Escapes」の節\u003C/a>に \u003Ccode>%*\u003C/code> の説明がある。\u003C/p>\n\u003Cblockquote>\n\u003Cp>\u003Cstrong>%*\u003C/strong>\u003C/p>\n\u003Cp>Current time of day in 24-hour format, with seconds.\u003C/p>\n\u003C/blockquote>\n\u003Chr>\n\u003Cp>……もうそろそろ、他人が使う可能性があるシェルスクリプトをzshで書いてもいいんですかねえ。\u003C/p>\n","シェルスクリプトを書くとき、 set -x することで実行されるコマンドを都度表示できるのはよく知られている（？）。set -x date sleep 1 date $ bash test.sh + date Wed May  1 08:32:59 PM JST 2024 + sleep 1 + date Wed May  1 08:33:00 PM JST 2024 実はzshでは、実行時刻も表示させることができる。PS4=&#x27;[%*] + &#x27;set -x date sleep 1 date $ zsh test.sh [20:34:13] + date Wed May  1 08:34:13 PM JST 2024 [20:34:13] + sleep 1 [20:34:14] + date Wed May  1 08:34:14 PM JST 2024 要するにプロンプトを自由に設定できるというわけ。ちなみに、man 1 zshparam に PS4 の説明があって、PS4 &lt;S&gt;The execution trace prompt. Default is ‘+%N:%i&",{"to":23},{"urlPath":14,"entities":24},[],false],"uses":{"url":1}}]}
