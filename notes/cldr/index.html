<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=global.css rel=preload as=style onload="this.onload=null;this.rel='stylesheet'"> <link href=manifest.json rel=manifest crossorigin=use-credentials> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{title:"ja-JP-u-ca-japaneseって何？ UnicodeのCLDRを読んでみよう（あるいは、JavaScriptで和暦を得る簡単なテクについて）",date:"2022-02-19T02:41:00.000Z",slug:"cldr",html:"\u003Cp\u003Eさて、JavaScriptで、ある日付（例えば今日）の和暦バージョンの文字列を得たいときに使える、次のような簡単なコードが知られている。\u003C\u002Fp\u003E\n\u003Cp\u003E（知られている気がする。知らなかったら、この記事をTwitterでシェアして、知らねーよとツイートして、また戻ってきて、続きを読んでください）\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E&gt; new Date().toLocaleDateString('ja-JP-u-ca-japanese', { dateStyle: 'long' })\n'令和4年2月19日'\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eでは、この \u003Ccode\u003Eja-JP-u-ca-japanese\u003C\u002Fcode\u003E という謎の文字列は何なのだろうか？\n和暦のデータは一体どこにあるのだろうか？\nということがこの記事のテーマである。\u003C\u002Fp\u003E\n\u003Ch1\u003E\u003Ccode\u003Eja-JP-u-ca-japanese\u003C\u002Fcode\u003E を分解してみる\u003C\u002Fh1\u003E\n\u003Cp\u003EまずMDN Web Docsで\u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FJavaScript\u002FReference\u002FGlobal_Objects\u002FDate\u002FtoLocaleDateString\"\u003EDate.prototype.toLocaleDateString()のページ\u003C\u002Fa\u003Eを見てみると、\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EThe locales and options arguments customize the behavior of the function and let applications specify the language whose formatting conventions should be used. In implementations, which ignore the locales and options arguments, the locale used and the form of the string returned are entirely implementation dependent.\nSee the Intl.DateTimeFormat() constructor for details on these parameters and how to use them.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003Eと書いてあるので、\u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FJavaScript\u002FReference\u002FGlobal_Objects\u002FIntl\u002FDateTimeFormat\u002FDateTimeFormat\"\u003EIntl.DateTimeFormat() constructorのページ\u003C\u002Fa\u003Eに飛ぶと、\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EA string with a BCP 47 language tag, or an array of such strings. To use the browser’s default locale, pass an empty array. Unicode extension are supported (for example “en-US-u-ca-buddhist”). For the general form and interpretation of the locales argument, see the Intl page.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003Eと書いてあり、さらに\u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FJavaScript\u002FReference\u002FGlobal_Objects\u002FIntl#locale_identification_and_negotiation\"\u003EIntl\u003C\u002Fa\u003Eに飛ぶと、\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EA locale identifier is a string that consists of:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003Ea language subtag,\u003C\u002Fli\u003E\n\u003Cli\u003E(optionally) a script subtag,\u003C\u002Fli\u003E\n\u003Cli\u003E(optionally) a region (or country) subtag,\u003C\u002Fli\u003E\n\u003Cli\u003E(optionally) one or more variant subtags (all of which must be unique),\u003C\u002Fli\u003E\n\u003Cli\u003E(optionally) one or more BCP 47 extension sequences, and\u003C\u002Fli\u003E\n\u003Cli\u003E(optionally) a private-use extension sequence\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003E…with all present subtags and sequences separated by hyphens. Locale identifiers are case-insensitive ASCII. However, it’s conventional to use title case (first letter capitalized, successive letters lower case) for script subtags, upper case for region subtags, and lower case for everything else.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003Eという記述を見つけることができる。\u003C\u002Fp\u003E\n\u003Cp\u003E要するに、\u003Ccode\u003Eja-JP-u-ca-japanese\u003C\u002Fcode\u003E とは、\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003E\u003Ccode\u003Eja\u003C\u002Fcode\u003E: 言語（日本語）を指定する\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FIETF_language_tag\"\u003Esubtag\u003C\u002Fa\u003E: IANA Language Subtag Registryに登録されている\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003EJP\u003C\u002Fcode\u003E: 地域（日本）を指定するsubtag\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Eu\u003C\u002Fcode\u003E: BCP 47拡張の一つ、Unicode拡張を指定する文字\n\u003Col\u003E\n\u003Cli\u003E\u003Ccode\u003Eca-japanese\u003C\u002Fcode\u003E: Unicode拡張の和暦を指定する文字列\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003Eからなるのである。\u003C\u002Fp\u003E\n\u003Cp\u003Eさらにここには\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EBCP 47 extension subtags are defined in the Unicode CLDR Project.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003Eと記述されている。\nこのCLDRとは何かについて、もう少し掘り下げてみよう。\u003C\u002Fp\u003E\n\u003Ch1\u003ECLDR\u003C\u002Fh1\u003E\n\u003Cp\u003ECommon Locale Data Repository、略してCLDRは、The Unicode Consortiumが提供するロケールデータのデータセットである。初登場は2003年。\nこれはかなり様々なデータを含む興味深いデータベースである。\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FCommon_Locale_Data_Repository\"\u003EWikipedia\u003C\u002Fa\u003Eによると、\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cul\u003E\n\u003Cli\u003ETranslations for language names\u003C\u002Fli\u003E\n\u003Cli\u003ETranslations for territory and country names\u003C\u002Fli\u003E\n\u003Cli\u003ETranslations for currency names, including singular\u002Fplural modifications\u003C\u002Fli\u003E\n\u003Cli\u003ETranslations for weekday, month, era, period of day, in full and abbreviated forms\u003C\u002Fli\u003E\n\u003Cli\u003ETranslations for time zones and example cities (or similar) for time zones\u003C\u002Fli\u003E\n\u003Cli\u003ETranslations for calendar fields\u003C\u002Fli\u003E\n\u003Cli\u003EPatterns for formatting\u002Fparsing dates or times of day\u003C\u002Fli\u003E\n\u003Cli\u003EExemplar sets of characters used for writing the language\u003C\u002Fli\u003E\n\u003Cli\u003EPatterns for formatting\u002Fparsing numbers\u003C\u002Fli\u003E\n\u003Cli\u003ERules for language-adapted collation\u003C\u002Fli\u003E\n\u003Cli\u003ERules for spelling out numbers as words\u003C\u002Fli\u003E\n\u003Cli\u003ERules for formatting numbers in traditional numeral systems (such as Roman and Armenian numerals)\u003C\u002Fli\u003E\n\u003Cli\u003ERules for transliteration between scripts, much of it based on BGN\u002FPCGN romanization\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003Eといった内容が含まれるそうだ。\n（余談だが、CLDRは日本語では共通ロケールデータリポジトリと呼ぶそうである。これもきちんとThe Unicode Consortiumによって\u003Ca href=\"http:\u002F\u002Fwww.unicode.org\u002Fterminology\u002Fterm_en_ja.html#C\"\u003E定義されている\u003C\u002Fa\u003E）\u003C\u002Fp\u003E\n\u003Cp\u003Eさて、このデータセットはGitHub上で閲覧することができる。\nいくつか興味深い例を見てみよう。\u003C\u002Fp\u003E\n\u003Ch1\u003ECLDRを覗いてみる\u003C\u002Fh1\u003E\n\u003Cp\u003Eまず\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002Fmain\u002Fcommon\u002Fmain\u002Fja.xml\"\u003Ecommon\u002Fmain\u002Fja.xml\u003C\u002Fa\u003Eを見てみよう。\nここには、日本語によるデータが含まれている。\u003C\u002Fp\u003E\n\u003Cp\u003E例えば、\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002F17b4fac37d9a0f323579e9a21f452a6688d1b648\u002Fcommon\u002Fmain\u002Fja.xml#L21-L27\"\u003E様々な言語の日本語での名称\u003C\u002Fa\u003Eや、\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cx-script src=\"https:\u002F\u002Femgithub.com\u002Fembed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L21-L27&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on\"\u003E\u003C\u002Fx-script\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002F17b4fac37d9a0f323579e9a21f452a6688d1b648\u002Fcommon\u002Fmain\u002Fja.xml#L9519-L9550\"\u003E数量の単位の名称\u003C\u002Fa\u003Eや\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cx-script src=\"https:\u002F\u002Femgithub.com\u002Fembed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L9519-L9550&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on\"\u003E\u003C\u002Fx-script\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E海外で使われる暦の各月の名称なんてのもあったり、（例えば\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002F17b4fac37d9a0f323579e9a21f452a6688d1b648\u002Fcommon\u002Fmain\u002Fja.xml#L1916-L1933\"\u003Eコプト暦\u003C\u002Fa\u003E）\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cx-script src=\"https:\u002F\u002Femgithub.com\u002Fembed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L1916-L1933&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on\"\u003E\u003C\u002Fx-script\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Eそしてもちろん\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002F17b4fac37d9a0f323579e9a21f452a6688d1b648\u002Fcommon\u002Fmain\u002Fja.xml#L3590-L3830\"\u003E日本の元号の名称\u003C\u002Fa\u003Eもある。\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cx-script src=\"https:\u002F\u002Femgithub.com\u002Fembed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L3590-L3830&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on\"\u003E\u003C\u002Fx-script\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E各元号がいつから始まるのかについては、\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002F17b4fac37d9a0f323579e9a21f452a6688d1b648\u002Fcommon\u002Fsupplemental\u002FsupplementalData.xml#L4593-L4603\"\u003E別のファイル\u003C\u002Fa\u003Eにある。\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cx-script src=\"https:\u002F\u002Femgithub.com\u002Fembed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fsupplemental%2FsupplementalData.xml%23L4593-L4603&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on\"\u003E\u003C\u002Fx-script\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Eもちろんこのデータは日本語のみ提供されているわけではない。\nつまり、興味深いことに、日本の元号を他言語で呼ぶ際の名称のデータもあるのである。\n（ただしカバレッジは微妙。全ての言語にデータが揃っているわけではないようだ）\u003C\u002Fp\u003E\n\u003Cp\u003E例えば\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002F17b4fac37d9a0f323579e9a21f452a6688d1b648\u002Fcommon\u002Fmain\u002Froot.xml#L2150-L2158\"\u003E英語\u003C\u002Fa\u003Eでは\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cx-script src=\"https:\u002F\u002Femgithub.com\u002Fembed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Froot.xml%23L2150-L2158&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on\"\u003E\u003C\u002Fx-script\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Eまた\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Funicode-org\u002Fcldr\u002Fblob\u002F17b4fac37d9a0f323579e9a21f452a6688d1b648\u002Fcommon\u002Fmain\u002Fru.xml#L3074-L3086\"\u003Eロシア語\u003C\u002Fa\u003Eでは、何故か “Эпоха” がついたりつかなかったりする（「〜時代」みたいな意味かな？）。\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cx-script src=\"https:\u002F\u002Femgithub.com\u002Fembed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fru.xml%23L3074-L3086&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on\"\u003E\u003C\u002Fx-script\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Eこういうデータがあるということは、つまりこういうことができる。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E&gt; new Date().toLocaleString('en-US-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })\n'Saturday, February 19, 4 Reiwa at 11:25:47 AM Japan Standard Time'\n&gt; new Date().toLocaleString('ko-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })\n'레이와 4년 2월 19일 토요일 오전 11시 25분 53초 일본 표준시'\n&gt; new Date().toLocaleString('fa-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })\n'شنبه ۱۹ فوریهٔ ۴ ریوا، ساعت ۱۱:۲۵:۵۸ (وقت عادی ژاپن)'\n&gt; new Date().toLocaleString('ru-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })\n'суббота, 19 февраля 4 г. Рэйва, 11:26:03 Япония, стандартное время'\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E確かに各言語に「令和」が翻訳されている。（読めないけど）\u003C\u002Fp\u003E\n\u003Cp\u003EそういえばGoogle 日本語入力のソースコードにも元号のデータが埋め込まれていたのを思い出す。\u003C\u002Fp\u003E\n\u003Cblockquote class=\"twitter-tweet\"\u003E\u003Cp lang=\"ja\" dir=\"ltr\"\u003EGoogle 日本語入力のソースコード。 \u003Ca href=\"https:\u002F\u002Ft.co\u002FgOBfU9Bsfo\"\u003Ehttps:\u002F\u002Ft.co\u002FgOBfU9Bsfo\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Ft.co\u002FlXwChxyFAi\"\u003Epic.twitter.com\u002FlXwChxyFAi\u003C\u002Fa\u003E\u003C\u002Fp\u003E&mdash; (@p_km) \u003Ca href=\"https:\u002F\u002Ftwitter.com\u002Fp_km\u002Fstatus\u002F664781052964028416?ref_src=twsrc%5Etfw\"\u003ENovember 12, 2015\u003C\u002Fa\u003E\u003C\u002Fblockquote\u003E \u003Cx-script async src=\"https:\u002F\u002Fplatform.twitter.com\u002Fwidgets.js\" charset=\"utf-8\"\u003E\u003C\u002Fx-script\u003E\n\u003Ch1\u003E余談——ISO 8601形式の日付を得る裏技（？）\u003C\u002Fh1\u003E\n\u003Cp\u003E関連はするが、話を変える。\u003C\u002Fp\u003E\n\u003Cp\u003EISO 8601という国際規格があり、日付や時刻のフォーマットが規定されている。\u003C\u002Fp\u003E\n\u003Cp\u003E実は一般に人間は色々な場面で、例えばファイル名に日付を入れる時とか、このISO形式を使って日付を書くべきであることが知られている（俺調べ）。\nこれについて語るのはまた別のブログ記事1本分くらいになると思うので省略するが、曖昧性のなさ、ソート可能性、ソフトウェアサポートの広さ、フォーマットの名称がきちんとあること、などがポイントであろう。\u003C\u002Fp\u003E\n\u003Cp\u003E当然JavaScriptのDateには \u003Ccode\u003EtoISOString\u003C\u002Fcode\u003E というメソッドがある。\u003C\u002Fp\u003E\n\u003Cp\u003EしかしJavaScriptで日付のISO形式表現（つまり、\u003Ccode\u003EYYYY-MM-DD\u003C\u002Fcode\u003E）を得たいというケースを考えてみよう。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E&gt; new Date(1992, 9 - 1, 28).toISOString()\n'1992-09-27T15:00:00.000Z'\n&gt; new Date(1992, 9 - 1, 28).toISOString().slice(0, 10)\n'1992-09-27'\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eこの例では、1992年9月28日という日付のISO形式表現を得ようとしたのであるが、\u003Ccode\u003EtoISOString\u003C\u002Fcode\u003E が常にタイムゾーンとしてUTCを採用したフォーマットで文字列を返してしまうため、時差の関係で日付が1日ずれてしまった。\nそのため、これを解決するには、年月日の数値を直接取り出して、桁数が少なければゼロ埋めして、ハイフンで繋げる、という面倒臭いコードを書かなければいけない。\u003C\u002Fp\u003E\n\u003Cp\u003Eしかし、CLDRをよくよく読んでみると、都合のいいことに \u003Ccode\u003EYYYY-MM-DD\u003C\u002Fcode\u003E を採用している言語が存在しているではないか！\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E32 results - 29 files\n\ncommon\u002Fmain\u002Faf.xml:\n  1555&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1556  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1557: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1558  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1559  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fbo.xml:\n  486  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  487  \t\t\t\t\t\t&lt;dateFormat&gt;\n  488: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  489  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  490  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fbrx.xml:\n  1252  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1253  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1254: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1255  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yyMd&lt;\u002FdatetimeSkeleton&gt;\n  1256  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fckb.xml:\n  1271  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1272  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1273: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1274  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1275  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fdz.xml:\n  1009  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1010  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1011: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1012  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1013  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fen_CA.xml:\n  336  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  337  \t\t\t\t\t\t&lt;dateFormat&gt;\n  338: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  339  \t\t\t\t\t\t\t&lt;pattern alt=&quot;variant&quot;&gt;d\u002FM\u002Fyy&lt;\u002Fpattern&gt;\n  340  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fen_SE.xml:\n  38  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  39  \t\t\t\t\t\t&lt;dateFormat&gt;\n  40: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  41  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  42  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Ffr_CA.xml:\n  1925  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1926  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1927: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1928  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1929  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fii.xml:\n  304  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  305  \t\t\t\t\t\t&lt;dateFormat&gt;\n  306: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  307  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  308  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fjgo.xml:\n  389  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  390  \t\t\t\t\t\t&lt;dateFormat&gt;\n  391: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  392  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  393  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Flo.xml:\n  2765  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  2766  \t\t\t\t\t\t&lt;dateFormat&gt;\n  2767: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  2768  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  2769  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Flrc.xml:\n  646  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  647  \t\t\t\t\t\t&lt;dateFormat&gt;\n  648: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  649  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  650  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Flt.xml:\n  1654  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1655  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1656: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1657  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1658  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\n  2144  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  2145  \t\t\t\t\t\t&lt;dateFormat&gt;\n  2146: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  2147  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  2148  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\n  2930  \t\t\t\t\t&lt;dateFormatLength type=&quot;medium&quot;&gt;\n  2931  \t\t\t\t\t\t&lt;dateFormat&gt;\n  2932: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  2933  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  2934  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\n  2936  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  2937  \t\t\t\t\t\t&lt;dateFormat&gt;\n  2938: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  2939  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  2940  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fmg.xml:\n  624  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  625  \t\t\t\t\t\t&lt;dateFormat&gt;\n  626: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  627  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  628  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fmgo.xml:\n  318  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  319  \t\t\t\t\t\t&lt;dateFormat&gt;\n  320: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  321  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  322  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Froot.xml:\n  1294  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1295  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1296: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1297  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1298  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Frw.xml:\n  438  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  439  \t\t\t\t\t\t&lt;dateFormat&gt;\n  440: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  441  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  442  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fsd.xml:\n  1403  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1404  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1405: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1406  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1407  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fse.xml:\n  767  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  768  \t\t\t\t\t\t&lt;dateFormat&gt;\n  769: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  770  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  771  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fsi.xml:\n  1489  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1490  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1491: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1492  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1493  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fsn.xml:\n  648  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  649  \t\t\t\t\t\t&lt;dateFormat&gt;\n  650: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  651  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  652  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fsv.xml:\n  2809  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  2810  \t\t\t\t\t\t&lt;dateFormat&gt;\n  2811: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  2812  \t\t\t\t\t\t\t&lt;datetimeSkeleton draft=&quot;contributed&quot;&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  2813  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fug.xml:\n  1659  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  1660  \t\t\t\t\t\t&lt;dateFormat&gt;\n  1661: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  1662  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  1663  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\ncommon\u002Fmain\u002Fxh.xml:\n  370  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  371  \t\t\t\t\t\t&lt;dateFormat&gt;\n  372: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  373  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  374  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\nseed\u002Fmain\u002Fmn_Mong_MN.xml:\n  110  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  111  \t\t\t\t\t\t&lt;dateFormat&gt;\n  112: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  113  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  114  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\nseed\u002Fmain\u002Fnso.xml:\n  308  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  309  \t\t\t\t\t\t&lt;dateFormat&gt;\n  310: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  311  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  312  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\nseed\u002Fmain\u002Fst.xml:\n  392  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  393  \t\t\t\t\t\t&lt;dateFormat&gt;\n  394: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  395  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  396  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\nseed\u002Fmain\u002Fsyr.xml:\n  608  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  609  \t\t\t\t\t\t&lt;dateFormat&gt;\n  610: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  611  \t\t\t\t\t\t\t&lt;datetimeSkeleton draft=&quot;unconfirmed&quot;&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  612  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\nseed\u002Fmain\u002Fts.xml:\n  321  \t\t\t\t\t&lt;dateFormatLength type=&quot;short&quot;&gt;\n  322  \t\t\t\t\t\t&lt;dateFormat&gt;\n  323: \t\t\t\t\t\t\t&lt;pattern&gt;y-MM-dd&lt;\u002Fpattern&gt;\n  324  \t\t\t\t\t\t\t&lt;datetimeSkeleton&gt;yMMdd&lt;\u002FdatetimeSkeleton&gt;\n  325  \t\t\t\t\t\t&lt;\u002FdateFormat&gt;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eこれを使うと、時差の問題なく変換ができる。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-js\"\u003E&gt; new Date(1992, 9 - 1, 28).toLocaleString('af', { dateStyle: 'short' })\n'1992-09-28'\n&gt; new Date(1992, 9 - 1, 28).toLocaleString('fr-CA', { dateStyle: 'short' })\n'1992-09-28'\n&gt; new Date(1992, 9 - 1, 28).toLocaleString('en-CA', { dateStyle: 'short' })\n'1992-09-28'\n&gt; new Date(1992, 9 - 1, 28).toLocaleString('sv', { dateStyle: 'short' })\n'1992-09-28'\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eというハックでした。\u003C\u002Fp\u003E\n",headline:"さて、JavaScriptで、ある日付（例えば今日）の和暦バージョンの文字列を得たいときに使える、次のような簡単なコードが知られている。 （知られている気がする。知らなかったら、この記事をTwit"},historyURL:"https:\u002F\u002Fgithub.com\u002Fkissge\u002Fyo.eki.do\u002Fcommits\u002Fmaster\u002Fnotes\u002Fcldr.md"}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.b795f5c8.js"}catch(e){main="/client/legacy/client.a43cae97.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <link href=client/client-9e2cfc0b.css rel=stylesheet><link href=client/[slug]-f92f0c12.css rel=stylesheet> <title>ja-JP-u-ca-japaneseって何？ UnicodeのCLDRを読んでみよう（あるいは、JavaScriptで和暦を得る簡単なテクについて） - 2022-02-19 | 葉月夜堂</title><link href=https://twitter.com/p_km rel=me data-svelte=svelte-119a9vg> <link href=https://webmention.io/yo.eki.do/webmention rel=webmention data-svelte=svelte-119a9vg> <link href=https://webmention.io/yo.eki.do/xmlrpc rel=pingback data-svelte=svelte-119a9vg><meta content=article data-svelte=svelte-14mnzgr property=og:type><meta content="ja-JP-u-ca-japaneseって何？ UnicodeのCLDRを読んでみよう（あるいは、JavaScriptで和暦を得る簡単なテクについて） - 2022-02-19 | 葉月夜堂" data-svelte=svelte-14mnzgr property=og:title><meta content="さて、JavaScriptで、ある日付（例えば今日）の和暦バージョンの文字列を得たいときに使える、次のような簡単なコードが知られている。 （知られている気がする。知らなかったら、この記事をTwit" data-svelte=svelte-14mnzgr property=og:description><meta content=葉月夜堂 data-svelte=svelte-14mnzgr property=og:site_name><meta content=https://yo.eki.do/images/default.png data-svelte=svelte-14mnzgr property=og:image> <link href=/client/client.b795f5c8.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-9e2cfc0b.css rel=preload as=style><link href=/client/[slug].dfe790e7.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/[slug]-f92f0c12.css rel=preload as=style></head> <body> <div id=sapper> <nav class=svelte-1vowuxu><ul class=svelte-1vowuxu><li class=svelte-1vowuxu><a href=. class=svelte-1vowuxu rel=prefetch>articles</a></li> <li class=svelte-1vowuxu><a href=about class=svelte-1vowuxu rel=prefetch>about</a></ul> </nav> <main class=svelte-gph4rb> <header class=svelte-bluf97><div class="svelte-bluf97 img-header" style=""></div> <h1 class=svelte-bluf97>ja-JP-u-ca-japaneseって何？ UnicodeのCLDRを読んでみよう（あるいは、JavaScriptで和暦を得る簡単なテクについて）</h1> <time class=svelte-bluf97>2022-02-19<span class=date-weak>T</span>11:41:00<span class=date-weak>+09:00</span></time> <div class=tags></div> <p class="svelte-bluf97 history"><a href=https://github.com/kissge/yo.eki.do/commits/master/notes/cldr.md>更新履歴</a></header> <div class="svelte-bluf97 content"><p>さて、JavaScriptで、ある日付（例えば今日）の和暦バージョンの文字列を得たいときに使える、次のような簡単なコードが知られている。</p> <p>（知られている気がする。知らなかったら、この記事をTwitterでシェアして、知らねーよとツイートして、また戻ってきて、続きを読んでください）</p> <pre><code class=language-js>> new Date().toLocaleDateString('ja-JP-u-ca-japanese', { dateStyle: 'long' })
'令和4年2月19日'
</code></pre> <p>では、この <code>ja-JP-u-ca-japanese</code> という謎の文字列は何なのだろうか？ 和暦のデータは一体どこにあるのだろうか？ ということがこの記事のテーマである。</p> <h1><code>ja-JP-u-ca-japanese</code> を分解してみる</h1> <p>まずMDN Web Docsで<a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString>Date.prototype.toLocaleDateString()のページ</a>を見てみると、</p> <blockquote> <p>The locales and options arguments customize the behavior of the function and let applications specify the language whose formatting conventions should be used. In implementations, which ignore the locales and options arguments, the locale used and the form of the string returned are entirely implementation dependent. See the Intl.DateTimeFormat() constructor for details on these parameters and how to use them.</p> </blockquote> <p>と書いてあるので、<a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat/DateTimeFormat>Intl.DateTimeFormat() constructorのページ</a>に飛ぶと、</p> <blockquote> <p>A string with a BCP 47 language tag, or an array of such strings. To use the browser’s default locale, pass an empty array. Unicode extension are supported (for example “en-US-u-ca-buddhist”). For the general form and interpretation of the locales argument, see the Intl page.</p> </blockquote> <p>と書いてあり、さらに<a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl#locale_identification_and_negotiation>Intl</a>に飛ぶと、</p> <blockquote> <p>A locale identifier is a string that consists of:</p> <ol> <li>a language subtag,</li> <li>(optionally) a script subtag,</li> <li>(optionally) a region (or country) subtag,</li> <li>(optionally) one or more variant subtags (all of which must be unique),</li> <li>(optionally) one or more BCP 47 extension sequences, and</li> <li>(optionally) a private-use extension sequence</li> </ol> <p>…with all present subtags and sequences separated by hyphens. Locale identifiers are case-insensitive ASCII. However, it’s conventional to use title case (first letter capitalized, successive letters lower case) for script subtags, upper case for region subtags, and lower case for everything else.</p> </blockquote> <p>という記述を見つけることができる。</p> <p>要するに、<code>ja-JP-u-ca-japanese</code> とは、</p> <ol> <li><code>ja</code>: 言語（日本語）を指定する<a href=https://en.wikipedia.org/wiki/IETF_language_tag>subtag</a>: IANA Language Subtag Registryに登録されている</li> <li><code>JP</code>: 地域（日本）を指定するsubtag</li> <li><code>u</code>: BCP 47拡張の一つ、Unicode拡張を指定する文字 <ol> <li><code>ca-japanese</code>: Unicode拡張の和暦を指定する文字列</li> </ol> </li> </ol> <p>からなるのである。</p> <p>さらにここには</p> <blockquote> <p>BCP 47 extension subtags are defined in the Unicode CLDR Project.</p> </blockquote> <p>と記述されている。 このCLDRとは何かについて、もう少し掘り下げてみよう。</p> <h1>CLDR</h1> <p>Common Locale Data Repository、略してCLDRは、The Unicode Consortiumが提供するロケールデータのデータセットである。初登場は2003年。 これはかなり様々なデータを含む興味深いデータベースである。<a href=https://en.wikipedia.org/wiki/Common_Locale_Data_Repository>Wikipedia</a>によると、</p> <blockquote> <ul> <li>Translations for language names</li> <li>Translations for territory and country names</li> <li>Translations for currency names, including singular/plural modifications</li> <li>Translations for weekday, month, era, period of day, in full and abbreviated forms</li> <li>Translations for time zones and example cities (or similar) for time zones</li> <li>Translations for calendar fields</li> <li>Patterns for formatting/parsing dates or times of day</li> <li>Exemplar sets of characters used for writing the language</li> <li>Patterns for formatting/parsing numbers</li> <li>Rules for language-adapted collation</li> <li>Rules for spelling out numbers as words</li> <li>Rules for formatting numbers in traditional numeral systems (such as Roman and Armenian numerals)</li> <li>Rules for transliteration between scripts, much of it based on BGN/PCGN romanization</li> </ul> </blockquote> <p>といった内容が含まれるそうだ。 （余談だが、CLDRは日本語では共通ロケールデータリポジトリと呼ぶそうである。これもきちんとThe Unicode Consortiumによって<a href=http://www.unicode.org/terminology/term_en_ja.html#C>定義されている</a>）</p> <p>さて、このデータセットはGitHub上で閲覧することができる。 いくつか興味深い例を見てみよう。</p> <h1>CLDRを覗いてみる</h1> <p>まず<a href=https://github.com/unicode-org/cldr/blob/main/common/main/ja.xml>common/main/ja.xml</a>を見てみよう。 ここには、日本語によるデータが含まれている。</p> <p>例えば、<a href=https://github.com/unicode-org/cldr/blob/17b4fac37d9a0f323579e9a21f452a6688d1b648/common/main/ja.xml#L21-L27>様々な言語の日本語での名称</a>や、</p> <p><x-script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L21-L27&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></x-script></p> <p><a href=https://github.com/unicode-org/cldr/blob/17b4fac37d9a0f323579e9a21f452a6688d1b648/common/main/ja.xml#L9519-L9550>数量の単位の名称</a>や</p> <p><x-script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L9519-L9550&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></x-script></p> <p>海外で使われる暦の各月の名称なんてのもあったり、（例えば<a href=https://github.com/unicode-org/cldr/blob/17b4fac37d9a0f323579e9a21f452a6688d1b648/common/main/ja.xml#L1916-L1933>コプト暦</a>）</p> <p><x-script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L1916-L1933&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></x-script></p> <p>そしてもちろん<a href=https://github.com/unicode-org/cldr/blob/17b4fac37d9a0f323579e9a21f452a6688d1b648/common/main/ja.xml#L3590-L3830>日本の元号の名称</a>もある。</p> <p><x-script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fja.xml%23L3590-L3830&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></x-script></p> <p>各元号がいつから始まるのかについては、<a href=https://github.com/unicode-org/cldr/blob/17b4fac37d9a0f323579e9a21f452a6688d1b648/common/supplemental/supplementalData.xml#L4593-L4603>別のファイル</a>にある。</p> <p><x-script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fsupplemental%2FsupplementalData.xml%23L4593-L4603&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></x-script></p> <p>もちろんこのデータは日本語のみ提供されているわけではない。 つまり、興味深いことに、日本の元号を他言語で呼ぶ際の名称のデータもあるのである。 （ただしカバレッジは微妙。全ての言語にデータが揃っているわけではないようだ）</p> <p>例えば<a href=https://github.com/unicode-org/cldr/blob/17b4fac37d9a0f323579e9a21f452a6688d1b648/common/main/root.xml#L2150-L2158>英語</a>では</p> <p><x-script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Froot.xml%23L2150-L2158&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></x-script></p> <p>また<a href=https://github.com/unicode-org/cldr/blob/17b4fac37d9a0f323579e9a21f452a6688d1b648/common/main/ru.xml#L3074-L3086>ロシア語</a>では、何故か “Эпоха” がついたりつかなかったりする（「〜時代」みたいな意味かな？）。</p> <p><x-script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Funicode-org%2Fcldr%2Fblob%2F17b4fac37d9a0f323579e9a21f452a6688d1b648%2Fcommon%2Fmain%2Fru.xml%23L3074-L3086&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></x-script></p> <p>こういうデータがあるということは、つまりこういうことができる。</p> <pre><code class=language-js>> new Date().toLocaleString('en-US-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })
'Saturday, February 19, 4 Reiwa at 11:25:47 AM Japan Standard Time'
> new Date().toLocaleString('ko-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })
'레이와 4년 2월 19일 토요일 오전 11시 25분 53초 일본 표준시'
> new Date().toLocaleString('fa-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })
'شنبه ۱۹ فوریهٔ ۴ ریوا، ساعت ۱۱:۲۵:۵۸ (وقت عادی ژاپن)'
> new Date().toLocaleString('ru-u-ca-japanese', { dateStyle: 'full', timeStyle: 'full' })
'суббота, 19 февраля 4 г. Рэйва, 11:26:03 Япония, стандартное время'
</code></pre> <p>確かに各言語に「令和」が翻訳されている。（読めないけど）</p> <p>そういえばGoogle 日本語入力のソースコードにも元号のデータが埋め込まれていたのを思い出す。</p> <blockquote class=twitter-tweet><p dir=ltr lang=ja>Google 日本語入力のソースコード。 <a href=https://t.co/gOBfU9Bsfo>https://t.co/gOBfU9Bsfo</a> <a href=https://t.co/lXwChxyFAi>pic.twitter.com/lXwChxyFAi</a></p>— (@p_km) <a href="https://twitter.com/p_km/status/664781052964028416?ref_src=twsrc%5Etfw">November 12, 2015</a></blockquote> <x-script src=https://platform.twitter.com/widgets.js async charset=utf-8></x-script> <h1>余談——ISO 8601形式の日付を得る裏技（？）</h1> <p>関連はするが、話を変える。</p> <p>ISO 8601という国際規格があり、日付や時刻のフォーマットが規定されている。</p> <p>実は一般に人間は色々な場面で、例えばファイル名に日付を入れる時とか、このISO形式を使って日付を書くべきであることが知られている（俺調べ）。 これについて語るのはまた別のブログ記事1本分くらいになると思うので省略するが、曖昧性のなさ、ソート可能性、ソフトウェアサポートの広さ、フォーマットの名称がきちんとあること、などがポイントであろう。</p> <p>当然JavaScriptのDateには <code>toISOString</code> というメソッドがある。</p> <p>しかしJavaScriptで日付のISO形式表現（つまり、<code>YYYY-MM-DD</code>）を得たいというケースを考えてみよう。</p> <pre><code class=language-js>> new Date(1992, 9 - 1, 28).toISOString()
'1992-09-27T15:00:00.000Z'
> new Date(1992, 9 - 1, 28).toISOString().slice(0, 10)
'1992-09-27'
</code></pre> <p>この例では、1992年9月28日という日付のISO形式表現を得ようとしたのであるが、<code>toISOString</code> が常にタイムゾーンとしてUTCを採用したフォーマットで文字列を返してしまうため、時差の関係で日付が1日ずれてしまった。 そのため、これを解決するには、年月日の数値を直接取り出して、桁数が少なければゼロ埋めして、ハイフンで繋げる、という面倒臭いコードを書かなければいけない。</p> <p>しかし、CLDRをよくよく読んでみると、都合のいいことに <code>YYYY-MM-DD</code> を採用している言語が存在しているではないか！</p> <pre><code>32 results - 29 files

common/main/af.xml:
  1555&lt;dateFormatLength type="short">
  1556  						&lt;dateFormat>
  1557: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1558  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1559  						&lt;/dateFormat>

common/main/bo.xml:
  486  					&lt;dateFormatLength type="short">
  487  						&lt;dateFormat>
  488: 							&lt;pattern>y-MM-dd&lt;/pattern>
  489  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  490  						&lt;/dateFormat>

common/main/brx.xml:
  1252  					&lt;dateFormatLength type="short">
  1253  						&lt;dateFormat>
  1254: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1255  							&lt;datetimeSkeleton>yyMd&lt;/datetimeSkeleton>
  1256  						&lt;/dateFormat>

common/main/ckb.xml:
  1271  					&lt;dateFormatLength type="short">
  1272  						&lt;dateFormat>
  1273: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1274  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1275  						&lt;/dateFormat>

common/main/dz.xml:
  1009  					&lt;dateFormatLength type="short">
  1010  						&lt;dateFormat>
  1011: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1012  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1013  						&lt;/dateFormat>

common/main/en_CA.xml:
  336  					&lt;dateFormatLength type="short">
  337  						&lt;dateFormat>
  338: 							&lt;pattern>y-MM-dd&lt;/pattern>
  339  							&lt;pattern alt="variant">d/M/yy&lt;/pattern>
  340  						&lt;/dateFormat>

common/main/en_SE.xml:
  38  					&lt;dateFormatLength type="short">
  39  						&lt;dateFormat>
  40: 							&lt;pattern>y-MM-dd&lt;/pattern>
  41  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  42  						&lt;/dateFormat>

common/main/fr_CA.xml:
  1925  					&lt;dateFormatLength type="short">
  1926  						&lt;dateFormat>
  1927: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1928  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1929  						&lt;/dateFormat>

common/main/ii.xml:
  304  					&lt;dateFormatLength type="short">
  305  						&lt;dateFormat>
  306: 							&lt;pattern>y-MM-dd&lt;/pattern>
  307  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  308  						&lt;/dateFormat>

common/main/jgo.xml:
  389  					&lt;dateFormatLength type="short">
  390  						&lt;dateFormat>
  391: 							&lt;pattern>y-MM-dd&lt;/pattern>
  392  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  393  						&lt;/dateFormat>

common/main/lo.xml:
  2765  					&lt;dateFormatLength type="short">
  2766  						&lt;dateFormat>
  2767: 							&lt;pattern>y-MM-dd&lt;/pattern>
  2768  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  2769  						&lt;/dateFormat>

common/main/lrc.xml:
  646  					&lt;dateFormatLength type="short">
  647  						&lt;dateFormat>
  648: 							&lt;pattern>y-MM-dd&lt;/pattern>
  649  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  650  						&lt;/dateFormat>

common/main/lt.xml:
  1654  					&lt;dateFormatLength type="short">
  1655  						&lt;dateFormat>
  1656: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1657  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1658  						&lt;/dateFormat>

  2144  					&lt;dateFormatLength type="short">
  2145  						&lt;dateFormat>
  2146: 							&lt;pattern>y-MM-dd&lt;/pattern>
  2147  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  2148  						&lt;/dateFormat>

  2930  					&lt;dateFormatLength type="medium">
  2931  						&lt;dateFormat>
  2932: 							&lt;pattern>y-MM-dd&lt;/pattern>
  2933  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  2934  						&lt;/dateFormat>

  2936  					&lt;dateFormatLength type="short">
  2937  						&lt;dateFormat>
  2938: 							&lt;pattern>y-MM-dd&lt;/pattern>
  2939  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  2940  						&lt;/dateFormat>

common/main/mg.xml:
  624  					&lt;dateFormatLength type="short">
  625  						&lt;dateFormat>
  626: 							&lt;pattern>y-MM-dd&lt;/pattern>
  627  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  628  						&lt;/dateFormat>

common/main/mgo.xml:
  318  					&lt;dateFormatLength type="short">
  319  						&lt;dateFormat>
  320: 							&lt;pattern>y-MM-dd&lt;/pattern>
  321  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  322  						&lt;/dateFormat>

common/main/root.xml:
  1294  					&lt;dateFormatLength type="short">
  1295  						&lt;dateFormat>
  1296: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1297  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1298  						&lt;/dateFormat>

common/main/rw.xml:
  438  					&lt;dateFormatLength type="short">
  439  						&lt;dateFormat>
  440: 							&lt;pattern>y-MM-dd&lt;/pattern>
  441  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  442  						&lt;/dateFormat>

common/main/sd.xml:
  1403  					&lt;dateFormatLength type="short">
  1404  						&lt;dateFormat>
  1405: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1406  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1407  						&lt;/dateFormat>

common/main/se.xml:
  767  					&lt;dateFormatLength type="short">
  768  						&lt;dateFormat>
  769: 							&lt;pattern>y-MM-dd&lt;/pattern>
  770  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  771  						&lt;/dateFormat>

common/main/si.xml:
  1489  					&lt;dateFormatLength type="short">
  1490  						&lt;dateFormat>
  1491: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1492  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1493  						&lt;/dateFormat>

common/main/sn.xml:
  648  					&lt;dateFormatLength type="short">
  649  						&lt;dateFormat>
  650: 							&lt;pattern>y-MM-dd&lt;/pattern>
  651  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  652  						&lt;/dateFormat>

common/main/sv.xml:
  2809  					&lt;dateFormatLength type="short">
  2810  						&lt;dateFormat>
  2811: 							&lt;pattern>y-MM-dd&lt;/pattern>
  2812  							&lt;datetimeSkeleton draft="contributed">yMMdd&lt;/datetimeSkeleton>
  2813  						&lt;/dateFormat>

common/main/ug.xml:
  1659  					&lt;dateFormatLength type="short">
  1660  						&lt;dateFormat>
  1661: 							&lt;pattern>y-MM-dd&lt;/pattern>
  1662  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  1663  						&lt;/dateFormat>

common/main/xh.xml:
  370  					&lt;dateFormatLength type="short">
  371  						&lt;dateFormat>
  372: 							&lt;pattern>y-MM-dd&lt;/pattern>
  373  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  374  						&lt;/dateFormat>

seed/main/mn_Mong_MN.xml:
  110  					&lt;dateFormatLength type="short">
  111  						&lt;dateFormat>
  112: 							&lt;pattern>y-MM-dd&lt;/pattern>
  113  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  114  						&lt;/dateFormat>

seed/main/nso.xml:
  308  					&lt;dateFormatLength type="short">
  309  						&lt;dateFormat>
  310: 							&lt;pattern>y-MM-dd&lt;/pattern>
  311  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  312  						&lt;/dateFormat>

seed/main/st.xml:
  392  					&lt;dateFormatLength type="short">
  393  						&lt;dateFormat>
  394: 							&lt;pattern>y-MM-dd&lt;/pattern>
  395  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  396  						&lt;/dateFormat>

seed/main/syr.xml:
  608  					&lt;dateFormatLength type="short">
  609  						&lt;dateFormat>
  610: 							&lt;pattern>y-MM-dd&lt;/pattern>
  611  							&lt;datetimeSkeleton draft="unconfirmed">yMMdd&lt;/datetimeSkeleton>
  612  						&lt;/dateFormat>

seed/main/ts.xml:
  321  					&lt;dateFormatLength type="short">
  322  						&lt;dateFormat>
  323: 							&lt;pattern>y-MM-dd&lt;/pattern>
  324  							&lt;datetimeSkeleton>yMMdd&lt;/datetimeSkeleton>
  325  						&lt;/dateFormat>
</code></pre> <p>これを使うと、時差の問題なく変換ができる。</p> <pre><code class=language-js>> new Date(1992, 9 - 1, 28).toLocaleString('af', { dateStyle: 'short' })
'1992-09-28'
> new Date(1992, 9 - 1, 28).toLocaleString('fr-CA', { dateStyle: 'short' })
'1992-09-28'
> new Date(1992, 9 - 1, 28).toLocaleString('en-CA', { dateStyle: 'short' })
'1992-09-28'
> new Date(1992, 9 - 1, 28).toLocaleString('sv', { dateStyle: 'short' })
'1992-09-28'
</code></pre> <p>というハックでした。</p> </div> <x-script src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js async data-ad-client=ca-pub-5159408992513362></x-script> <section class="svelte-bluf97 mentions"><h1 class=svelte-bluf97>Recent public mentions on Twitter</h1> <ol>Loading mentions...</ol> </section> </main></div> 