<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{from:"wordpress",title:"Emacs: まだターミナルで消耗してるの？",date:"2015-12-04T23:00:02.000Z",tags:["advent"],slug:"tramp-mode",html:"\u003Cp\u003Eこの記事は\u003Ca href=\"http:\u002F\u002Fqiita.com\u002Fadvent-calendar\u002F2015\u002Femacs\"\u003EEmacs Advent Calendar 2015\u003C\u002Fa\u003Eの第5日目の記事として書かれました。\n第4日目は\u003Ca href=\"http:\u002F\u002Fqiita.com\u002Fniku\"\u003Eniku\u003C\u002Fa\u003Eさんによる記事の予定です。「org-babelについて書くかも」とのこと。\n第6日目は\u003Ca href=\"http:\u002F\u002Fqiita.com\u002Ftakaxp\"\u003Etakaxp\u003C\u002Fa\u003Eさんによる記事の予定です。「何も書かずに2015年を終えられると思うほど堕落してはおらんっ」とのこと。\u003C\u002Fp\u003E\n\u003C!--more--\u003E\n\u003Ch2\u003Eずいぶんとダサい開発をしているのね\u003C\u002Fh2\u003E\n\u003Cp\u003E所属柄私の周りには少なくないEmacsユーザがいるのに、だれも \u003Ccode\u003Etramp-mode\u003C\u002Fcode\u003E のことを知らないようでここ数ヶ月で2、3回同じことを説明するはめになったのでついでにここにも書くことにします。\n初心者に説明する意図での記述なのでコアなユーザの方には物足りないものかもしれません。\u003C\u002Fp\u003E\n\u003Cp\u003Eさてみなさん普段GUIでEmacs使ってますか？\n使ってるのにときどきCUIを使わざるを得ないという状況に陥りますか？\nだいたいそういうケースは次のどちらかのパターンなのではないでしょうか。\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003Erootとしてファイルを開きたい（\u003Ccode\u003Esudo\u003C\u002Fcode\u003E したい）とき\u003C\u002Fli\u003E\n\u003Cli\u003Essh先のサーバ上でファイルを編集したいとき\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003Eまあどちらもままあることです。2. に至っては「手元（ローカル）のEmacsとで設定ファイルが共有されていないから不便／共有するのが面倒」なんてことになってませんか？よくないやつですね。\nこういった問題を全て解決する簡単な方法のひとつが \u003Ccode\u003Etramp-mode\u003C\u002Fcode\u003E です。\u003C\u002Fp\u003E\n\u003Ch2\u003E\u003Ccode\u003Etramp-mode\u003C\u002Fcode\u003E で \u003Ccode\u003Esudo\u003C\u002Fcode\u003E してみる\u003C\u002Fh2\u003E\n\u003Cp\u003Eというわけで幾つかの使用例を見てみましょう。\n\u003Ccode\u003Etramp-mode\u003C\u002Fcode\u003E はいま普通にEmacsを使っているユーザの大半の環境では最初から入っているかと思いますが、22.1より古いバージョンを使っている方が万が一いればEmacsをバージョンアップしてください。\u003C\u002Fp\u003E\n\u003Cp\u003Eたとえば \u003Ccode\u003E\u002Fetc\u002Fhttpd\u002Fconf\u002Fhttpd.conf\u003C\u002Fcode\u003E を開くとき、普通に開くとread-onlyとなり\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003ENote: file is write protected\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eと怒られるかと思います。これをrootとして開くには次のように\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EC-x C-f \u002Fsudo::\u002Fetc\u002Fhttpd\u002Fconf\u002Fhttpd.conf\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eと \u003Ccode\u003Efind-file\u003C\u002Fcode\u003E に渡すパスの前に \u003Ccode\u003E\u002Fsudo::\u003C\u002Fcode\u003E を追加するだけです。\n\u003Ccode\u003E\u002Fsu::\u003C\u002Fcode\u003E なら更に短縮できますね（挙動の違いは見てお分かりの通りです）。\u003C\u002Fp\u003E\n\u003Ch2\u003E\u003Ccode\u003Etramp-mode\u003C\u002Fcode\u003E でssh先のサーバ上のファイルを編集してみる\u003C\u002Fh2\u003E\n\u003Cp\u003E同じように、sshで接続できる外部サーバ上のファイルを開くには\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EC-x C-f \u002Fuser@example.com:path\u002Fto\u002Ffile\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eです。ユーザ名とホスト名のあとは \u003Ccode\u003E\u002F\u003C\u002Fcode\u003E からはじめてフルパスを書くか、あるいは \u003Ccode\u003E$HOME\u003C\u002Fcode\u003E からの相対パスを書くことが出来ます。\n実はこの記法は接続メソッドが自動でデフォルトで補われているもので、次の略記です。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E\u002Fscp:user@example.com:path\u002Fto\u002Ffile\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eこの \u003Ccode\u003Escp\u003C\u002Fcode\u003E はいくつかある接続メソッドの一つです。\nメソッドを省略した場合は \u003Ccode\u003Etramp-default-method\u003C\u002Fcode\u003E という変数の内容を見て決定されます。\nEmacs 24.3くらいまではこの変数のデフォルト値は \u003Ccode\u003Escpc\u003C\u002Fcode\u003E だったような気がしますが廃止されました。\n\u003Ccode\u003Escp\u003C\u002Fcode\u003E では基本的にホストとの接続はsshで行われ、ファイルの転送はscpで行われます。\n頻繁にファイルを開いたり閉じたりする場合にはscpのオーバヘッドが効いて、すべてsshで行う \u003Ccode\u003Essh\u003C\u002Fcode\u003E というメソッドのほうが速い場合もあります。\u003C\u002Fp\u003E\n\u003Cp\u003Eちなみに \u003Ccode\u003Eshell\u003C\u002Fcode\u003E も開けるし \u003Ccode\u003Ecompile\u003C\u002Fcode\u003E だって出来ます。便利〜\u003C\u002Fp\u003E\n\u003Ch2\u003Essh先からsshした先のファイルを編集する\u003C\u002Fh2\u003E\n\u003Cp\u003E何だか日本語が怪しいですが、いわゆる踏み台サーバみたいなものが中間にある状況です。これもままあるかとおもいます。\nもっともよい解決策はsshのconfigに \u003Ccode\u003EProxyCommand\u003C\u002Fcode\u003E を設定することでこのホップを自動で行わせることでしょう。\nたとえば \u003Ccode\u003Eexample1.com\u003C\u002Fcode\u003E に繋ぐために \u003Ccode\u003Eexample2.com\u003C\u002Fcode\u003E に一旦繋ぐ必要がある場合には、sshのconfig（たとえば \u003Ccode\u003E~\u002F.ssh\u002Fconfig\u003C\u002Fcode\u003E ）に\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EHost example1\n    HostName example1.com\n    ProxyCommand ssh example2 -W %h:%p 2&gt; \u002Fdev\u002Fnull\nHost example2\n    HostName example2.com\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eなどと書くことでターミナルから\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E$ ssh example1\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eだけで一発で目的のホストに繋ぐことが出来ます。この設定をしているときにはEmacsで\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EC-x C-f \u002Fexample1:path\u002Fto\u002Ffile\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eとするとこのホップを裏で自動で行ってもらうことが出来ます。\u003C\u002Fp\u003E\n\u003Cp\u003Eもう一つの方法は \u003Ccode\u003Etramp-mode\u003C\u002Fcode\u003E で明示的にホップさせることです。\nおそらくいま使われているような最近のバージョン (24.3以降) ですと\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EC-x C-f \u002Fssh:example2.com|ssh:example1.com:path\u002Fto\u002Ffile\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eで同じことが出来るかと思います。\u003C\u002Fp\u003E\n\u003Ch2\u003Essh先でsudoする\u003C\u002Fh2\u003E\n\u003Cp\u003Eここまで読むともう次に何をするかはおわかりでしょう。実際ssh先でroot権限でファイルを読むこともよくありますよね。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EC-x C-f \u002Fssh:user@example.com|sudo:example.com:\u002Fetc\u002Fhttpd\u002Fconf\u002Fhttpd.conf\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003E陥りがちなトラップ\u003C\u002Fh2\u003E\n\u003Cp\u003Eいくつか注意点のようなもの。\u003C\u002Fp\u003E\n\u003Cp\u003Eホップして踏み台越しの接続をするときに \u003Ccode\u003E\u002Fssh:foo|sudo:foo:\u002Fetc\u002F...\u003C\u002Fcode\u003E のように \u003Ccode\u003Essh\u003C\u002Fcode\u003E を省略することは出来ません。\n上述のようにこの場合デフォルトの \u003Ccode\u003Escp\u003C\u002Fcode\u003E が使用されますが、このメソッドはホップに対応していません。\nまた、\u003Ccode\u003Esudo::\u003C\u002Fcode\u003E とホストを省略する記法もここでは使えません。\u003C\u002Fp\u003E\n\u003Cp\u003Eまた、 \u003Ccode\u003Etramp-mode\u003C\u002Fcode\u003E で繋ぐ先のホストのログインシェルがzshの場合、接続がうまくいかない場合があります。\nよく見受けられる対処法（私も使っています）は、 \u003Ccode\u003E.zshrc\u003C\u002Fcode\u003E の1行目にEmacsからの接続を識別する場合分けを追加することのようです。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E[[ $TERM == &quot;dumb&quot; ]] &amp;&amp; unsetopt zle &amp;&amp; PS1='$ ' &amp;&amp; return\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eもう一点上級者向けっぽいことを書くと、システムグローバルな設定のままControlMasterを使うようにカスタマイズする場合、Emacsで最初にshared connectionを開いてからターミナルなどでsshセッションを開き、Emacsを終了するとターミナルの方も同時に落ちる、というようなことになる場合があります。\nこのへんは好き好きというか、一般にどうするのがよいのか不明です。\nカスタマイズしなければ関係ないですが。\u003C\u002Fp\u003E\n\u003Ch2\u003E結論：便利なので使いましょう\u003C\u002Fh2\u003E\n\u003Cp\u003Eというわけで画像もなくずらずらと使い方を書いてみました。\n本当にstraightforwardなのでとくに説明することもないですね。インストールもないし。\nご存知なかった方はぜひぜひ使い倒してみてください。\nではでは。\u003C\u002Fp\u003E\n\u003Ch2\u003Eところで関係ないけど\u003C\u002Fh2\u003E\n\u003Cp\u003EEmacs 24.5で \u003Ccode\u003E;;;###tramp-autoload\u003C\u002Fcode\u003E にバグがあるような気がするのですがHEADで再現しないのでどこかに報告したほうがいいのかどうなのか分からずにいる。\n具体的には\u003C\u002Fp\u003E\n\u003Cscript src=\"https:\u002F\u002Fgist.github.com\u002Fkissge\u002Fa9f1c59959181856280f.js\"\u003E\u003C\u002Fscript\u003E\n\u003Cp\u003Eを使って\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Eemacs -q -l init.el\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eなどとして起動した後\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EC-h v tramp-verbose\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eとすると設定通り変数が変更されているのが確認できるが\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EC-h v tramp-use-ssh-controlmaster-options\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eとするとデフォルトの設定で上書きされている。\n\u003Ccode\u003Etramp-use-ssh-controlmaster-options\u003C\u002Fcode\u003E 以外にも \u003Ccode\u003E;;;###tramp-autoload\u003C\u002Fcode\u003E が指定されている変数で同様の現象が確認できる。\u003C\u002Fp\u003E\n",headline:"この記事は\u003Ca href=\"http:\u002F\u002Fqiita.com\u002Fadvent-calendar\u002F2015\u002Femacs\"\u003EEmacs Advent Calendar 2015\u003C\u002Fa\u003Eの第5日目の記事として"},historyURL:"https:\u002F\u002Fgithub.com\u002Fkissge\u002Fyo.eki.do\u002Fcommits\u002Fmaster\u002Fnotes\u002Ftramp-mode.md"}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.0ca573ee.js"}catch(e){main="/client/legacy/client.bac0e44a.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <link href=client/client-9e2cfc0b.css rel=stylesheet><link href=client/[slug]-cf2c2a67.css rel=stylesheet> <title>Emacs: まだターミナルで消耗してるの？ - 2015-12-04 | 葉月夜堂</title><link href=https://twitter.com/p_km rel=me data-svelte=svelte-119a9vg> <link href=https://webmention.io/yo.eki.do/webmention rel=webmention data-svelte=svelte-119a9vg> <link href=https://webmention.io/yo.eki.do/xmlrpc rel=pingback data-svelte=svelte-119a9vg><meta content=article data-svelte=svelte-14mnzgr property=og:type><meta content="Emacs: まだターミナルで消耗してるの？ - 2015-12-04 | 葉月夜堂" data-svelte=svelte-14mnzgr property=og:title><meta content='この記事は<a href="http://qiita.com/advent-calendar/2015/emacs">Emacs Advent Calendar 2015</a>の第5日目の記事として' data-svelte=svelte-14mnzgr property=og:description><meta content=葉月夜堂 data-svelte=svelte-14mnzgr property=og:site_name><meta content=https://yo.eki.do/images/default.png data-svelte=svelte-14mnzgr property=og:image> <link href=/client/client.0ca573ee.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-9e2cfc0b.css rel=preload as=style><link href=/client/[slug].92f33706.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/[slug]-cf2c2a67.css rel=preload as=style></head> <body> <div id=sapper> <nav class=svelte-1vowuxu><ul class=svelte-1vowuxu><li class=svelte-1vowuxu><a href=. class=svelte-1vowuxu rel=prefetch>articles</a></li> <li class=svelte-1vowuxu><a href=about class=svelte-1vowuxu rel=prefetch>about</a></ul> </nav> <main class=svelte-gph4rb> <header class=svelte-1xsha26><div class="svelte-1xsha26 img-header" style=""></div> <h1 class=svelte-1xsha26>Emacs: まだターミナルで消耗してるの？</h1> <time class=svelte-1xsha26>2015-12-05T08:00:02+09:00</time> <div class=tags><div class="svelte-1xsha26 tag">#advent</div></div> <p class="svelte-1xsha26 history"><a href=https://github.com/kissge/yo.eki.do/commits/master/notes/tramp-mode.md>更新履歴</a></header> <div class="svelte-1xsha26 callout">この記事は以前別のところにあったものを移してきたものです。完璧に移植できておらず、表示が崩れているかもしれません。 </div> <div class="svelte-1xsha26 content"><p>この記事は<a href=http://qiita.com/advent-calendar/2015/emacs>Emacs Advent Calendar 2015</a>の第5日目の記事として書かれました。 第4日目は<a href=http://qiita.com/niku>niku</a>さんによる記事の予定です。「org-babelについて書くかも」とのこと。 第6日目は<a href=http://qiita.com/takaxp>takaxp</a>さんによる記事の予定です。「何も書かずに2015年を終えられると思うほど堕落してはおらんっ」とのこと。</p> <h2>ずいぶんとダサい開発をしているのね</h2> <p>所属柄私の周りには少なくないEmacsユーザがいるのに、だれも <code>tramp-mode</code> のことを知らないようでここ数ヶ月で2、3回同じことを説明するはめになったのでついでにここにも書くことにします。 初心者に説明する意図での記述なのでコアなユーザの方には物足りないものかもしれません。</p> <p>さてみなさん普段GUIでEmacs使ってますか？ 使ってるのにときどきCUIを使わざるを得ないという状況に陥りますか？ だいたいそういうケースは次のどちらかのパターンなのではないでしょうか。</p> <ol> <li>rootとしてファイルを開きたい（<code>sudo</code> したい）とき</li> <li>ssh先のサーバ上でファイルを編集したいとき</li> </ol> <p>まあどちらもままあることです。2. に至っては「手元（ローカル）のEmacsとで設定ファイルが共有されていないから不便／共有するのが面倒」なんてことになってませんか？よくないやつですね。 こういった問題を全て解決する簡単な方法のひとつが <code>tramp-mode</code> です。</p> <h2><code>tramp-mode</code> で <code>sudo</code> してみる</h2> <p>というわけで幾つかの使用例を見てみましょう。 <code>tramp-mode</code> はいま普通にEmacsを使っているユーザの大半の環境では最初から入っているかと思いますが、22.1より古いバージョンを使っている方が万が一いればEmacsをバージョンアップしてください。</p> <p>たとえば <code>/etc/httpd/conf/httpd.conf</code> を開くとき、普通に開くとread-onlyとなり</p> <pre><code>Note: file is write protected
</code></pre> <p>と怒られるかと思います。これをrootとして開くには次のように</p> <pre><code>C-x C-f /sudo::/etc/httpd/conf/httpd.conf
</code></pre> <p>と <code>find-file</code> に渡すパスの前に <code>/sudo::</code> を追加するだけです。 <code>/su::</code> なら更に短縮できますね（挙動の違いは見てお分かりの通りです）。</p> <h2><code>tramp-mode</code> でssh先のサーバ上のファイルを編集してみる</h2> <p>同じように、sshで接続できる外部サーバ上のファイルを開くには</p> <pre><code>C-x C-f /user@example.com:path/to/file
</code></pre> <p>です。ユーザ名とホスト名のあとは <code>/</code> からはじめてフルパスを書くか、あるいは <code>$HOME</code> からの相対パスを書くことが出来ます。 実はこの記法は接続メソッドが自動でデフォルトで補われているもので、次の略記です。</p> <pre><code>/scp:user@example.com:path/to/file
</code></pre> <p>この <code>scp</code> はいくつかある接続メソッドの一つです。 メソッドを省略した場合は <code>tramp-default-method</code> という変数の内容を見て決定されます。 Emacs 24.3くらいまではこの変数のデフォルト値は <code>scpc</code> だったような気がしますが廃止されました。 <code>scp</code> では基本的にホストとの接続はsshで行われ、ファイルの転送はscpで行われます。 頻繁にファイルを開いたり閉じたりする場合にはscpのオーバヘッドが効いて、すべてsshで行う <code>ssh</code> というメソッドのほうが速い場合もあります。</p> <p>ちなみに <code>shell</code> も開けるし <code>compile</code> だって出来ます。便利〜</p> <h2>ssh先からsshした先のファイルを編集する</h2> <p>何だか日本語が怪しいですが、いわゆる踏み台サーバみたいなものが中間にある状況です。これもままあるかとおもいます。 もっともよい解決策はsshのconfigに <code>ProxyCommand</code> を設定することでこのホップを自動で行わせることでしょう。 たとえば <code>example1.com</code> に繋ぐために <code>example2.com</code> に一旦繋ぐ必要がある場合には、sshのconfig（たとえば <code>~/.ssh/config</code> ）に</p> <pre><code>Host example1
    HostName example1.com
    ProxyCommand ssh example2 -W %h:%p 2> /dev/null
Host example2
    HostName example2.com
</code></pre> <p>などと書くことでターミナルから</p> <pre><code>$ ssh example1
</code></pre> <p>だけで一発で目的のホストに繋ぐことが出来ます。この設定をしているときにはEmacsで</p> <pre><code>C-x C-f /example1:path/to/file
</code></pre> <p>とするとこのホップを裏で自動で行ってもらうことが出来ます。</p> <p>もう一つの方法は <code>tramp-mode</code> で明示的にホップさせることです。 おそらくいま使われているような最近のバージョン (24.3以降) ですと</p> <pre><code>C-x C-f /ssh:example2.com|ssh:example1.com:path/to/file
</code></pre> <p>で同じことが出来るかと思います。</p> <h2>ssh先でsudoする</h2> <p>ここまで読むともう次に何をするかはおわかりでしょう。実際ssh先でroot権限でファイルを読むこともよくありますよね。</p> <pre><code>C-x C-f /ssh:user@example.com|sudo:example.com:/etc/httpd/conf/httpd.conf
</code></pre> <h2>陥りがちなトラップ</h2> <p>いくつか注意点のようなもの。</p> <p>ホップして踏み台越しの接続をするときに <code>/ssh:foo|sudo:foo:/etc/...</code> のように <code>ssh</code> を省略することは出来ません。 上述のようにこの場合デフォルトの <code>scp</code> が使用されますが、このメソッドはホップに対応していません。 また、<code>sudo::</code> とホストを省略する記法もここでは使えません。</p> <p>また、 <code>tramp-mode</code> で繋ぐ先のホストのログインシェルがzshの場合、接続がうまくいかない場合があります。 よく見受けられる対処法（私も使っています）は、 <code>.zshrc</code> の1行目にEmacsからの接続を識別する場合分けを追加することのようです。</p> <pre><code>[[ $TERM == "dumb" ]] && unsetopt zle && PS1='$ ' && return
</code></pre> <p>もう一点上級者向けっぽいことを書くと、システムグローバルな設定のままControlMasterを使うようにカスタマイズする場合、Emacsで最初にshared connectionを開いてからターミナルなどでsshセッションを開き、Emacsを終了するとターミナルの方も同時に落ちる、というようなことになる場合があります。 このへんは好き好きというか、一般にどうするのがよいのか不明です。 カスタマイズしなければ関係ないですが。</p> <h2>結論：便利なので使いましょう</h2> <p>というわけで画像もなくずらずらと使い方を書いてみました。 本当にstraightforwardなのでとくに説明することもないですね。インストールもないし。 ご存知なかった方はぜひぜひ使い倒してみてください。 ではでは。</p> <h2>ところで関係ないけど</h2> <p>Emacs 24.5で <code>;;;###tramp-autoload</code> にバグがあるような気がするのですがHEADで再現しないのでどこかに報告したほうがいいのかどうなのか分からずにいる。 具体的には</p> <script src=https://gist.github.com/kissge/a9f1c59959181856280f.js></script> <p>を使って</p> <pre><code>emacs -q -l init.el
</code></pre> <p>などとして起動した後</p> <pre><code>C-h v tramp-verbose
</code></pre> <p>とすると設定通り変数が変更されているのが確認できるが</p> <pre><code>C-h v tramp-use-ssh-controlmaster-options
</code></pre> <p>とするとデフォルトの設定で上書きされている。 <code>tramp-use-ssh-controlmaster-options</code> 以外にも <code>;;;###tramp-autoload</code> が指定されている変数で同様の現象が確認できる。</p> </div> </main></div> 