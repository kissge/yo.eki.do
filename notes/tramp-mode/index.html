<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/images/favicon.svg" type="image/svg+xml" />
    <link
      rel="preload"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/github.min.css"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Shippori+Mincho+B1:wght@400;800&amp;display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <meta http-equiv="content-security-policy" content=""><title>Emacs: まだターミナルで消耗してるの？ - 2015-12-05 | 葉月夜堂</title><link href="https://twitter.com/p_km" rel="me" data-svelte="svelte-czc0wy">
    <link rel="webmention" href="https://webmention.io/yo.eki.do/webmention" data-svelte="svelte-czc0wy">
    <link rel="pingback" href="https://webmention.io/yo.eki.do/xmlrpc" data-svelte="svelte-czc0wy"><meta property="og:site_name" content="葉月夜堂" data-svelte="svelte-czc0wy"><meta property="og:type" content="article" data-svelte="svelte-a8kw7e"><meta property="og:title" content="Emacs: まだターミナルで消耗してるの？ - 2015-12-05 | 葉月夜堂" data-svelte="svelte-a8kw7e"><meta property="og:description" content="この記事はEmacs Advent Calendar 2015の第5日目の記事として書かれました。第4日目はnikuさんによる記事の予定です。「org-babelについて書くかも」とのこと。第6日目はtakaxpさんによる記事の予定です。「何も書かずに2015年を終えられると思うほど堕落してはおらんっ」とのこと。ずいぶんとダサい開発をしているのね所属柄私の周りには少なくないEmacsユーザがいるのに、だれも tramp-mode のことを知らないようでここ数ヶ月で2、3回同じことを説明するはめになったのでついでにここにも書くことにします。初心者に説明する意図での記述なのでコアなユーザの方には物足りないものかもしれません。さてみなさん普段GUIでEmacs使ってますか？使ってるのにときどきCUIを使わざるを得ないという状況に陥りますか？だいたいそういうケースは次のどちらかのパターンなのではないでしょうか。rootとしてファイルを開きたい（sudo したい）ときssh先のサーバ上でファイルを編集したいときまあどちらもままあることです。2. に至っては「手元（ローカル）のEmacsとで設定ファイルが共有されていない" data-svelte="svelte-a8kw7e"><meta property="og:image" content="https://yo.eki.do/images/favicon.svg" data-svelte="svelte-a8kw7e">
	<style>*,*:before,*:after{box-sizing:border-box}body,h1,h2,h3,h4,p,figure,blockquote,dl,dd{margin:0}ul[role=list],ol[role=list]{list-style:none}html:focus-within{scroll-behavior:smooth}body{min-height:100vh;text-rendering:optimizeSpeed;line-height:1.5}a:not([class]){text-decoration-skip-ink:auto}img,picture{max-width:100%;display:block}input,button,textarea,select{font:inherit}@media (prefers-reduced-motion: reduce){html:focus-within{scroll-behavior:auto}*,*:before,*:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}@font-face{font-family:Emoji;src:local("Segoe UI Emoji"),local("Segoe UI Symbol"),local("Apple Color Emoji"),local("Noto Color Emoji"),local("Noto Emoji");font-display:swap;unicode-range:U+203C,U+2049,U+20E3,U+2139,U+231A-231B,U+2328,U+23CF,U+23E9-23F3,U+23F8-23FA,U+25AA-25AB,U+25FB-25FE,U+2600-2604,U+260E,U+2611,U+2614-2615,U+2618,U+261D,U+2620,U+2622-2623,U+2626,U+262A,U+262E-262F,U+2638-263A,U+2648-2653,U+2660,U+2663,U+2665-2666,U+2668,U+267B,U+267F,U+2692-2697,U+2699,U+269B-269C,U+26A0-26A1,U+26AA-26AB,U+26B0-26B1,U+26BD-26BE,U+26C4-26C5,U+26C8,U+26CE-26CF,U+26D1,U+26D3-26D4,U+26E9-26EA,U+26F0-26F5,U+26F7-26FA,U+26FD,U+2702,U+2705,U+2708-270D,U+270F,U+2712,U+2714,U+2716,U+271D,U+2721,U+2728,U+2733-2734,U+2744,U+2747,U+274C,U+274E,U+2753-2755,U+2757,U+2763-2764,U+2795-2797,U+27A1,U+27B0,U+27BF,U+2B05-2B07,U+2B1B-2B1C,U+2B50,U+2B55,U+3030,U+3297,U+3299,U+FE0F,U+1F004,U+1F0CF,U+1F170-1F171,U+1F17E-1F17F,U+1F18E,U+1F191-1F19A,U+1F1E6-1F1FF,U+1F201-1F202,U+1F21A,U+1F22F,U+1F232-1F23A,U+1F250-1F251,U+1F300-1F321,U+1F324-1F393,U+1F396-1F397,U+1F399-1F39B,U+1F39E-1F3F0,U+1F3F3-1F3F5,U+1F3F7-1F4FD,U+1F4FF-1F53D,U+1F549-1F54E,U+1F550-1F567,U+1F56F-1F570,U+1F573-1F57A,U+1F587,U+1F58A-1F58D,U+1F590,U+1F595-1F596,U+1F5A4-1F5A5,U+1F5A8,U+1F5B1-1F5B2,U+1F5BC,U+1F5C2-1F5C4,U+1F5D1-1F5D3,U+1F5DC-1F5DE,U+1F5E1,U+1F5E3,U+1F5E8,U+1F5EF,U+1F5F3,U+1F5FA-1F64F,U+1F680-1F6C5,U+1F6CB-1F6D2,U+1F6E0-1F6E5,U+1F6E9,U+1F6EB-1F6EC,U+1F6F0,U+1F6F3-1F6F8,U+1F910-1F93A,U+1F93C-1F93E,U+1F940-1F945,U+1F947-1F94C,U+1F950-1F96B,U+1F980-1F997,U+1F9C0,U+1F9D0-1F9E6,U+E0062-E0063,U+E0065,U+E0067,U+E006C,U+E006E,U+E0073-E0074,U+E0077,U+E007F}@font-face{font-weight:700;font-family:Emoji;font-display:swap;src:local("Segoe UI Emoji"),local("Segoe UI Symbol"),local("Apple Color Emoji"),local("Noto Color Emoji") local("Noto Emoji");unicode-range:U+203C,U+2049,U+20E3,U+2139,U+231A-231B,U+2328,U+23CF,U+23E9-23F3,U+23F8-23FA,U+25AA-25AB,U+25FB-25FE,U+2600-2604,U+260E,U+2611,U+2614-2615,U+2618,U+261D,U+2620,U+2622-2623,U+2626,U+262A,U+262E-262F,U+2638-263A,U+2648-2653,U+2660,U+2663,U+2665-2666,U+2668,U+267B,U+267F,U+2692-2697,U+2699,U+269B-269C,U+26A0-26A1,U+26AA-26AB,U+26B0-26B1,U+26BD-26BE,U+26C4-26C5,U+26C8,U+26CE-26CF,U+26D1,U+26D3-26D4,U+26E9-26EA,U+26F0-26F5,U+26F7-26FA,U+26FD,U+2702,U+2705,U+2708-270D,U+270F,U+2712,U+2714,U+2716,U+271D,U+2721,U+2728,U+2733-2734,U+2744,U+2747,U+274C,U+274E,U+2753-2755,U+2757,U+2763-2764,U+2795-2797,U+27A1,U+27B0,U+27BF,U+2B05-2B07,U+2B1B-2B1C,U+2B50,U+2B55,U+3030,U+3297,U+3299,U+FE0F,U+1F004,U+1F0CF,U+1F170-1F171,U+1F17E-1F17F,U+1F18E,U+1F191-1F19A,U+1F1E6-1F1FF,U+1F201-1F202,U+1F21A,U+1F22F,U+1F232-1F23A,U+1F250-1F251,U+1F300-1F321,U+1F324-1F393,U+1F396-1F397,U+1F399-1F39B,U+1F39E-1F3F0,U+1F3F3-1F3F5,U+1F3F7-1F4FD,U+1F4FF-1F53D,U+1F549-1F54E,U+1F550-1F567,U+1F56F-1F570,U+1F573-1F57A,U+1F587,U+1F58A-1F58D,U+1F590,U+1F595-1F596,U+1F5A4-1F5A5,U+1F5A8,U+1F5B1-1F5B2,U+1F5BC,U+1F5C2-1F5C4,U+1F5D1-1F5D3,U+1F5DC-1F5DE,U+1F5E1,U+1F5E3,U+1F5E8,U+1F5EF,U+1F5F3,U+1F5FA-1F64F,U+1F680-1F6C5,U+1F6CB-1F6D2,U+1F6E0-1F6E5,U+1F6E9,U+1F6EB-1F6EC,U+1F6F0,U+1F6F3-1F6F8,U+1F910-1F93A,U+1F93C-1F93E,U+1F940-1F945,U+1F947-1F94C,U+1F950-1F96B,U+1F980-1F997,U+1F9C0,U+1F9D0-1F9E6,U+E0062-E0063,U+E0065,U+E0067,U+E006C,U+E006E,U+E0073-E0074,U+E0077,U+E007F}body{padding-top:4rem;color:#222;font-weight:400;font-family:Emoji,"Shippori Mincho B1",serif;line-height:1.8;text-underline-offset:.1em}a{color:#3d2fb9;text-decoration:underline;transition:text-decoration-color .15s ease-in-out;text-decoration-color:#d5d0fb}a:hover{text-decoration-color:transparent}.link-icon{margin-right:3px;height:1em;vertical-align:middle;transform:translateY(-1px)}.monolog-link.empty{color:#b92f3d;text-decoration:none}nav{position:fixed;top:0;left:0;z-index:999;padding:1rem .5rem;width:100%;height:4rem}nav ul{margin:0;padding:0}nav li{display:inline-block;margin-right:5px}nav a{position:relative;padding:0 1em;color:#222;text-decoration:none;text-shadow:0 0 8px #fff,0 0 8px #fff,0 0 8px #fff;transition:text-shadow 4s ease-in-out}nav a:after{position:absolute;bottom:calc(-1rem - 7px);left:0;display:block;width:0;height:5px;background-color:#eee;content:"";transition:width .2s ease-in-out}nav a:hover,nav a[aria-current]{text-shadow:0 0 8px #fff,0 0 8px #fff,0 0 8px #fff,0 0 8px #fff,0 0 8px #fff,0 0 8px #fff,0 0 8px #fff,0 0 8px #fff,0 0 8px #fff;transition-duration:.2s}nav a:hover:after,nav a[aria-current]:after{width:100%}nav a[href="/"]:before{display:inline-block;margin-right:3px;margin-left:1px;width:1em;height:1em;background-image:url(/images/favicon.svg);background-size:contain;content:"";vertical-align:middle}nav.isTop{border-bottom:1px solid #ccc;background-image:url(/images/default.svg);background-position:left top;background-size:cover}.global-footer{padding:2em;text-align:center;font-size:.8em}.global-footer:not(:hover){opacity:.5}main{margin:40px auto;padding:0 40px;max-width:1000px}.links{display:table;margin:0;padding:0;border-spacing:0 3em;border-collapse:separate;line-height:1.6}@media screen and (max-width: 800px){.links{display:block;margin-top:3em;border-spacing:unset}}.link-group{display:table-row}@media screen and (max-width: 800px){.link-group{display:block;margin-bottom:3em}}.link-group-title{display:table-cell;padding-right:1em;width:11em;font-weight:inherit;font-size:1em}@media screen and (max-width: 800px){.link-group-title{display:block;margin-bottom:1em;padding-right:0;width:auto;font-size:1.2em}}.link-group-links{display:table-cell;padding-left:1em;border-left:1px solid #ccc;list-style:none}@media screen and (max-width: 800px){.link-group-links{display:block;padding-left:0;border-left:none}}.link{margin-bottom:.4em;padding-left:2em;text-indent:-2em}@media screen and (max-width: 800px){.link{padding-left:1em;text-indent:-1em}}.link>*{text-indent:0}.link .tags{white-space:nowrap}.link p{display:inline;padding-left:5px;color:#757575}.link small{color:#333;white-space:nowrap;font-size:.6em}:target{animation:target-highlight 1s 3}@keyframes target-highlight{0%{background:#eee}to{background:unset}}sup{vertical-align:super;font-size:smaller}img{display:revert}

@charset "UTF-8";.monolog-link.svelte-1ytxadn:before{display:inline-block;padding-right:.5em;width:1.75em;vertical-align:baseline;text-align:center;font-size:.75em}.mentions.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{margin-top:40px;padding-top:40px;border-top:1px solid #ccc}@media screen and (max-width: 512px){.mentions.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{padding-top:20px}}h1.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{font-size:1.3em}ol.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{padding-left:1em}@media screen and (max-width: 800px){ol.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{padding-left:0}}li.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{margin-bottom:1em;line-height:1.4}li.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik::marker{color:#aaa}li.svelte-19gm1ik span.svelte-19gm1ik.svelte-19gm1ik{display:inline-block}@media screen and (max-width: 800px){li.svelte-19gm1ik span.svelte-19gm1ik.svelte-19gm1ik{display:block;margin-left:1em}}a.no-color.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{text-decoration:none}a.no-color.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik:not(:hover){color:currentColor}a.no-color.svelte-19gm1ik img.svelte-19gm1ik.svelte-19gm1ik{margin:0 5px}img.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{width:1em;height:1em;vertical-align:middle;transform:translateY(-2px)}blockquote.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{margin-top:.4em;margin-left:2em;padding-left:1em;border-left:1px solid #ccc;font-style:italic;font-size:.8em}.reaction.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{display:flex;float:right;margin-top:.3em;margin-bottom:1em;gap:.5em}.reaction.svelte-19gm1ik a.svelte-19gm1ik.svelte-19gm1ik{display:block;padding-left:2.1875em;height:1.704375em;background-size:contain;background-repeat:no-repeat;text-decoration:none;line-height:1.35}@media (hover: hover){.reaction.svelte-19gm1ik a.svelte-19gm1ik.svelte-19gm1ik:not(:hover){opacity:.5}}.reaction.svelte-19gm1ik a.svelte-19gm1ik small.svelte-19gm1ik{display:block;font-size:.2em}.reaction.svelte-19gm1ik a.svelte-19gm1ik span.svelte-19gm1ik{display:block;font-size:.7em}@media screen and (max-width: 370px){.reaction.svelte-19gm1ik a.svelte-19gm1ik.svelte-19gm1ik{font-size:.65em}}@media screen and (max-width: 512px){.reaction.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik{float:none;justify-content:space-between}}.loading.svelte-19gm1ik.svelte-19gm1ik.svelte-19gm1ik:before{display:block;padding-left:1.3em;background-image:url(https://cdnjs.cloudflare.com/ajax/libs/galleriffic/2.0.1/css/loader.gif);background-size:contain;background-repeat:no-repeat;color:#aaa;content:"\8aad\307f\8fbc\307f\4e2d";line-height:.9}.tag.svelte-o20os9{display:inline-block;margin-left:.3em;padding:.1em .4em;border-radius:5px;background-color:#eee;text-decoration:none;white-space:nowrap;font-size:.7em;line-height:1.4;opacity:.65;transition:opacity .5s ease-in-out}li:hover>.tag.svelte-o20os9,li:hover>span>.tag.svelte-o20os9{opacity:1}.tag.svelte-o20os9:hover{background-color:#ddd}.tag.large.svelte-o20os9{margin-right:.3em;margin-left:0;font-size:1em;opacity:1}.tag.svelte-o20os9:before{color:#757575}time.svelte-5ni4x2.svelte-5ni4x2{white-space:nowrap}span.svelte-5ni4x2.svelte-5ni4x2{opacity:.1;transition:opacity .1s ease-in-out}.svelte-5ni4x2:not(:hover)>span.svelte-5ni4x2{opacity:.3}

@charset "UTF-8";header.svelte-1askvef.svelte-1askvef.svelte-1askvef{margin-bottom:2em;transition:padding-top .2s ease-in-out,margin-bottom .2s ease-in-out}header.svelte-1askvef.svelte-1askvef.svelte-1askvef:not(.noHeaderImage){padding-top:360px}@media screen and (max-width: 1050px){header.svelte-1askvef:not(.noHeaderImage) h1.svelte-1askvef.svelte-1askvef:before{margin-top:-1em}}header.svelte-1askvef h1.svelte-1askvef.svelte-1askvef{word-break:keep-all;font-weight:700;font-size:2em;line-height:1.2;overflow-wrap:break-word}@media screen and (max-width: 800px){header.svelte-1askvef h1.svelte-1askvef.svelte-1askvef{font-size:1.7em;line-height:1.3}}header.svelte-1askvef h1.svelte-1askvef~section.svelte-1askvef{margin-top:1.5em}header.svelte-1askvef h1.svelte-1askvef.svelte-1askvef:before{display:inline-block;margin-left:-3em;padding-right:.5em;width:3em;text-align:right}@media screen and (max-width: 1050px){header.svelte-1askvef h1.svelte-1askvef.svelte-1askvef:before{display:block;margin-bottom:.25em;margin-left:0;padding-right:0;text-align:left;font-size:1.5em}}header.svelte-1askvef h2.svelte-1askvef.svelte-1askvef{font-weight:inherit;font-size:1em}header.svelte-1askvef .meta.svelte-1askvef.svelte-1askvef{float:right;text-align:right}@media screen and (max-width: 800px){header.svelte-1askvef .meta.svelte-1askvef.svelte-1askvef{float:unset}}header.svelte-1askvef .meta p.svelte-1askvef.svelte-1askvef{margin:.25em 0}header.svelte-1askvef .url a.svelte-1askvef.svelte-1askvef{color:#444;font-weight:700;font-family:monospace}header.svelte-1askvef .toolbar.svelte-1askvef.svelte-1askvef{clear:both;margin:8em 0;text-align:right}header.svelte-1askvef button.svelte-1askvef.svelte-1askvef{padding:.3em 1em;font-size:1.2em}header.svelte-1askvef.svelte-1askvef.svelte-1askvef:after{display:block;clear:both;content:""}.header-image.svelte-1askvef.svelte-1askvef.svelte-1askvef{position:absolute;top:0;left:0;z-index:-999;margin:0;width:100%;height:400px;background-image:url(/images/default.svg);background-position:center center;background-size:cover;transition:height .2s ease-in-out}.header-image.noHeaderImage.svelte-1askvef.svelte-1askvef.svelte-1askvef{height:4rem}.body.svelte-1askvef.svelte-1askvef.svelte-1askvef{line-height:2;overflow-wrap:break-word}.links-section.svelte-1askvef.svelte-1askvef.svelte-1askvef{margin-top:120px;border-top:1px solid #ccc;transition:margin-top .2s ease-in-out,border-top-color 1s ease-in-out}.nav-background.svelte-1askvef.svelte-1askvef.svelte-1askvef{position:fixed;top:0;left:0;z-index:998;width:100%;height:4rem;background-image:url(/images/default.svg);background-position:center center;background-size:cover;transition:height .7s ease-in-out}.nav-background.svelte-1askvef.svelte-1askvef.svelte-1askvef:after{position:absolute;top:0;left:0;display:block;width:100%;height:100%;border-bottom:1px solid #ccc;content:"";transition:all 1.5s .7s ease-out}.nav-background.isHeaderInView.svelte-1askvef.svelte-1askvef.svelte-1askvef{height:0;transition-duration:.1s}.nav-background.isHeaderInView.svelte-1askvef.svelte-1askvef.svelte-1askvef:after{width:0;border-bottom-color:#222;transition:none}.empty.svelte-1askvef header.svelte-1askvef.svelte-1askvef{margin-bottom:0}.empty.svelte-1askvef header h1.svelte-1askvef.svelte-1askvef{color:#681a22}.empty.svelte-1askvef .links-section.svelte-1askvef.svelte-1askvef{margin-top:0;border-top-color:transparent}.body>*{margin:1.5em 0;max-width:100%}.body h1,.body h2,.body h3,.body h4,.body h5,.body h6{font-weight:700;line-height:1.3}.body>h1:before,.body>h2:before,.body>h3:before,.body>h4:before,.body>h5:before,.body>h6:before{display:inline-block;margin-left:-8em;padding-right:8px;width:8em;text-align:right;opacity:.3}.body h1{font-size:1.8em}.body h2{font-size:1.5em}.body h3{font-size:1.2em}.body>h1:before{content:"#"}.body>h2:before{content:"##"}.body>h3:before{content:"###"}.body>h4:before{content:"####"}.body>h5:before{content:"#####"}.body>h6:before{content:"######"}.body p{text-align:justify;text-indent:1em}.body blockquote{padding-left:1.2em;border-left:5px solid #8fb6f0}.body pre{overflow:auto;padding:1.5em;max-height:60vh;border-radius:3px;background-color:#f9f9f9;box-shadow:inset 1px 1px 5px #0000000d;white-space:pre;font-family:monospace;line-height:1.4;-webkit-locale:"auto"}.body ol,.body ul{display:block;padding-inline-start:3em}.body ol ul,.body ul ul{list-style-type:circle}.body ol ol,.body ol ul,.body ul ol,.body ul ul{border-left:1px dashed transparent}.body ol ol ul,.body ol ul ul,.body ul ol ul,.body ul ul ul{list-style-type:square}.body ol ol ol ul,.body ol ol ul ul,.body ol ul ol ul,.body ol ul ul ul,.body ul ol ol ul,.body ul ol ul ul,.body ul ul ol ul,.body ul ul ul ul{list-style-type:disc}.body ol ol:hover>li:not(:hover),.body ol ul:hover>li:not(:hover),.body ul ol:hover>li:not(:hover),.body ul ul:hover>li:not(:hover){opacity:.35;transition-delay:2s}.body ol:hover>li>*>li:hover,.body ul:hover>li>*>li:hover{position:relative}.body ol:hover>li>*>li:hover:before,.body ul:hover>li>*>li:hover:before{position:absolute;top:-.25em;left:-2.75em;display:block;width:8px;content:"\2937";font-weight:700;opacity:.5}.body ol>li:hover>ol,.body ol>li:hover>ul,.body ul>li:hover>ol,.body ul>li:hover>ul{border-left-color:#ccc}.body ol{list-style-type:decimal}.body ol>li>ol,.body ol>li>ul{margin-inline-start:-.75em;padding-inline-start:3.75em}.body ul{list-style-type:disc}.body ul>li>ol,.body ul>li>ul{margin-inline-start:-1.05em;padding-inline-start:4.05em}.body>ol,.body>ul,.body blockquote>ol,.body blockquote>ul{padding-inline-start:1em}.body li{transition:opacity .5s 0s ease-in-out}.body .table-wrapper{overflow:auto}@media screen and (min-width: 1400px){.body .table-wrapper{margin-right:calc((100% - (100vw - 40px))/2);margin-left:calc((100% - (100vw - 40px))/2);max-width:calc(100vw - 40px)}}.body table{margin:1.5em -550% 1.5em -.5em;max-width:650%;width:auto;border-spacing:.5em;border-collapse:separate;font-size:.8em;line-height:1.4}@media screen and (min-width: 1400px){.body table{margin:0 auto}}.body table thead th{border-bottom:2px solid #888;font-weight:700}.body table tbody tr:nth-child(even){background-color:#f7f1f1}.body table th,.body table td{padding:.4em}.body table [align=center]{text-align:center}.body table [align=right]{text-align:right}.body figure{max-width:unset;text-align:center;transition:margin 1s 2s ease-in-out}.body figure img{box-shadow:0 0 12px 3px #ccc8}.body figure:hover{margin-right:calc((100vw - 100% - 25px)/-2);margin-left:calc((100vw - 100% - 25px)/-2)}.body figcaption{color:#888;font-size:.8em;line-height:1.25}.body>img{display:block;margin:1.5em auto}.body>iframe{display:block;margin:1.5em auto}.body hr{display:block;margin:3em 0;border-top:1px solid #ccc}.body .footnotes{margin-top:6em;color:#888}.body del{color:#777;text-decoration:line-through;transition:text-decoration-color .15s ease-in-out;text-decoration-color:#af2929;text-decoration-thickness:3px}.body del:hover{opacity:.5;text-decoration-color:transparent}.body strong{font-weight:700}.body :not(em)>strong{background:linear-gradient(transparent 60%,#eef7cd 60%)}.body em{font-style:italic}.body :not(strong)>em{background:linear-gradient(transparent 60%,#e0f3f8 60%)}.body :not(pre)>code{padding:.2em .4em;border-radius:2px;background-color:#f0f0f0;color:#555;font-size:calc(1em - 2px);font-family:Menlo,Inconsolata,monospace}.body kbd{margin:0 5px;padding:.2em .4em;border:1px solid #999;border-radius:6px;background-color:#fcfcfc;color:#555;white-space:nowrap;font-size:calc(1em - 2px);font-family:Menlo,Inconsolata,monospace}.body .footnote-link a{text-decoration:none}.body a.monolog-link:before,.body a[href="/"]:before{display:inline-block;margin-right:3px;margin-left:1px;width:1em;height:1em;background-image:url(/images/favicon.svg);background-size:contain;content:"";vertical-align:middle}.body .ipa{font-family:Charis SIL,Doulos SIL,DejaVu Sans,Code2000,Hiragino Kaku Gothic Pro,Matrix Unicode,Tahoma,"Microsoft Sans Serif",sans-serif}@media screen and (min-width: 800px){.body .float-right{float:right;margin:.5em 0 .8em 1.2em;width:300px}}@media screen and (max-width: 800px){.body .float-right{width:100%}}
</style>
	<link rel="stylesheet" href="/_app/immutable/assets/pages/__layout.svelte-a27ec198.css" disabled media="(max-width: 0)">
	<link rel="stylesheet" href="/_app/immutable/assets/time.svelte_svelte_type_style_lang-8d43daca.css" disabled media="(max-width: 0)">
	<link rel="stylesheet" href="/_app/immutable/assets/pages/_...entity_.svelte-fd60fffd.css" disabled media="(max-width: 0)">
	<link rel="modulepreload" href="/_app/immutable/start-ef4dd391.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-c60afc50.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/preload-helper-60cab3ee.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/singletons-d1fb5791.js">
	<link rel="modulepreload" href="/_app/immutable/pages/__layout.svelte-347b6206.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/stores-b2ad3934.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/time.svelte_svelte_type_style_lang-44100545.js">
	<link rel="modulepreload" href="/_app/immutable/pages/_...entity_.svelte-e31b7802.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/tags-b31c3cf6.js">
  </head>
  <body>
    <div>




<nav><ul><li><a sveltekit:prefetch href="/">葉月夜堂</a>
      </li><li><a sveltekit:prefetch href="/timeline">timeline</a>
      </li><li><a sveltekit:prefetch href="/about">about</a>
      </li></ul></nav>



<div class="nav-background svelte-1askvef isHeaderInView" style=""></div>

<main><article data-kind="note" class="svelte-1askvef"><header class="viewer-header svelte-1askvef"><h1 class="svelte-1askvef">Emacs: まだ<wbr>ターミナルで<wbr>消耗してるの？</h1>

      

      <section class="meta svelte-1askvef"><p class="svelte-1askvef"><time title="7 年前" class="svelte-5ni4x2">Fri Dec 04 2015 23:00:02 GMT+0000 (Coordinated Universal Time)</time></p>

        <p class="svelte-1askvef"><a href="https://github.com/kissge/yo.eki.do/commits/master/notes/tramp-mode.md" title="Sat Jun 11 2022 07:33:39 GMT+0000 (Coordinated Universal Time)" class="svelte-1askvef">最終更新：3 か月半前</a></p></section>

      

      <section class="svelte-1askvef"><a sveltekit:prefetch href="/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC" class="tag svelte-o20os9 large" data-kind="tag">アドベントカレンダー</a>
  </section>

      

      <section class="header-image svelte-1askvef" style=""></section></header>

    <section class="body svelte-1askvef"><!-- HTML_TAG_START --><p>この記事は<a href="http://qiita.com/advent-calendar/2015/emacs">Emacs Advent Calendar 2015</a>の第5日目の記事として書かれました。第4日目は<a href="http://qiita.com/niku">niku</a>さんによる記事の予定です。「org-babelについて書くかも」とのこと。第6日目は<a href="http://qiita.com/takaxp">takaxp</a>さんによる記事の予定です。「何も書かずに2015年を終えられると思うほど堕落してはおらんっ」とのこと。</p>
<!--more-->

<h2 id="ずいぶんとダサい開発をしているのね">ずいぶんとダサい開発をしているのね</h2>
<p>所属柄私の周りには少なくないEmacsユーザがいるのに、だれも <code>tramp-mode</code> のことを知らないようでここ数ヶ月で2、3回同じことを説明するはめになったのでついでにここにも書くことにします。初心者に説明する意図での記述なのでコアなユーザの方には物足りないものかもしれません。</p>
<p>さてみなさん普段GUIでEmacs使ってますか？
使ってるのにときどきCUIを使わざるを得ないという状況に陥りますか？
だいたいそういうケースは次のどちらかのパターンなのではないでしょうか。</p>
<ol>
<li>rootとしてファイルを開きたい（<code>sudo</code> したい）とき</li>
<li>ssh先のサーバ上でファイルを編集したいとき</li>
</ol>
<p>まあどちらもままあることです。2. に至っては「手元（ローカル）のEmacsとで設定ファイルが共有されていないから不便／共有するのが面倒」なんてことになってませんか？よくないやつですね。こういった問題を全て解決する簡単な方法のひとつが <code>tramp-mode</code> です。</p>
<h2 id="tramp-mode-で-sudo-してみる"><code>tramp-mode</code> で <code>sudo</code> してみる</h2>
<p>というわけで幾つかの使用例を見てみましょう。<code>tramp-mode</code> はいま普通にEmacsを使っているユーザの大半の環境では最初から入っているかと思いますが、22.1より古いバージョンを使っている方が万が一いればEmacsをバージョンアップしてください。</p>
<p>たとえば <code>/etc/httpd/conf/httpd.conf</code> を開くとき、普通に開くとread-onlyとなり</p>
<pre><code>Note: file is write protected
</code></pre>
<p>と怒られるかと思います。これをrootとして開くには次のように</p>
<pre><code>C-x C-f /sudo::/etc/httpd/conf/httpd.conf
</code></pre>
<p>と <code>find-file</code> に渡すパスの前に <code>/sudo::</code> を追加するだけです。<code>/su::</code> なら更に短縮できますね（挙動の違いは見てお分かりの通りです）。</p>
<h2 id="tramp-mode-でssh先のサーバ上のファイルを編集してみる"><code>tramp-mode</code> でssh先のサーバ上のファイルを編集してみる</h2>
<p>同じように、sshで接続できる外部サーバ上のファイルを開くには</p>
<pre><code>C-x C-f /user@example.com:path/to/file
</code></pre>
<p>です。ユーザ名とホスト名のあとは <code>/</code> からはじめてフルパスを書くか、あるいは <code>$HOME</code> からの相対パスを書くことが出来ます。実はこの記法は接続メソッドが自動でデフォルトで補われているもので、次の略記です。</p>
<pre><code>/scp:user@example.com:path/to/file
</code></pre>
<p>この <code>scp</code> はいくつかある接続メソッドの一つです。メソッドを省略した場合は <code>tramp-default-method</code> という変数の内容を見て決定されます。Emacs 24.3くらいまではこの変数のデフォルト値は <code>scpc</code> だったような気がしますが廃止されました。<code>scp</code> では基本的にホストとの接続はsshで行われ、ファイルの転送はscpで行われます。頻繁にファイルを開いたり閉じたりする場合にはscpのオーバヘッドが効いて、すべてsshで行う <code>ssh</code> というメソッドのほうが速い場合もあります。</p>
<p>ちなみに <code>shell</code> も開けるし <code>compile</code> だって出来ます。便利〜</p>
<h2 id="ssh先からsshした先のファイルを編集する">ssh先からsshした先のファイルを編集する</h2>
<p>何だか<a href="/mono/%E6%97%A5%E6%9C%AC%E8%AA%9E" class="monolog-link" sveltekit:prefetch title="日本語">日本語</a>が怪しいですが、いわゆる踏み台サーバみたいなものが中間にある状況です。これもままあるかとおもいます。もっともよい解決策はsshのconfigに <code>ProxyCommand</code> を設定することでこのホップを自動で行わせることでしょう。たとえば <code>example1.com</code> に繋ぐために <code>example2.com</code> に一旦繋ぐ必要がある場合には、sshのconfig（たとえば <code>~/.ssh/config</code> ）に</p>
<pre><code>Host example1
    HostName example1.com
    ProxyCommand ssh example2 -W %h:%p 2&gt; /dev/null
Host example2
    HostName example2.com
</code></pre>
<p>などと書くことでターミナルから</p>
<pre><code class="language-sh">$ ssh example1
</code></pre>
<p>だけで一発で目的のホストに繋ぐことが出来ます。この設定をしているときにはEmacsで</p>
<pre><code>C-x C-f /example1:path/to/file
</code></pre>
<p>とするとこのホップを裏で自動で行ってもらうことが出来ます。</p>
<p>もう一つの方法は <code>tramp-mode</code> で明示的にホップさせることです。おそらくいま使われているような最近のバージョン (24.3以降) ですと</p>
<pre><code>C-x C-f /ssh:example2.com|ssh:example1.com:path/to/file
</code></pre>
<p>で同じことが出来るかと思います。</p>
<h2 id="ssh先でsudoする">ssh先でsudoする</h2>
<p>ここまで読むともう次に何をするかはおわかりでしょう。実際ssh先でroot権限でファイルを読むこともよくありますよね。</p>
<pre><code>C-x C-f /ssh:user@example.com|sudo:example.com:/etc/httpd/conf/httpd.conf
</code></pre>
<h2 id="陥りがちなトラップ">陥りがちなトラップ</h2>
<p>いくつか注意点のようなもの。</p>
<p>ホップして踏み台越しの接続をするときに <code>/ssh:foo|sudo:foo:/etc/...</code> のように <code>ssh</code> を省略することは出来ません。上述のようにこの場合デフォルトの <code>scp</code> が使用されますが、このメソッドはホップに対応していません。また、<code>sudo::</code> とホストを省略する記法もここでは使えません。</p>
<p>また、 <code>tramp-mode</code> で繋ぐ先のホストのログインシェルがzshの場合、接続がうまくいかない場合があります。よく見受けられる対処法（私も使っています）は、 <code>.zshrc</code> の1行目にEmacsからの接続を識別する場合分けを追加することのようです。</p>
<pre><code class="language-sh">[[ <span class="hljs-variable">$TERM</span> == <span class="hljs-string">&quot;dumb&quot;</span> ]] &amp;&amp; <span class="hljs-built_in">unsetopt</span> <span class="hljs-built_in">zle</span> &amp;&amp; PS1=<span class="hljs-string">&#x27;$ &#x27;</span> &amp;&amp; <span class="hljs-built_in">return</span>
</code></pre>
<p>もう一点上級者向けっぽいことを書くと、システムグローバルな設定のままControlMasterを使うようにカスタマイズする場合、Emacsで最初にshared connectionを開いてからターミナルなどでsshセッションを開き、Emacsを終了するとターミナルの方も同時に落ちる、というようなことになる場合があります。このへんは好き好きというか、一般にどうするのがよいのか不明です。カスタマイズしなければ関係ないですが。</p>
<h2 id="結論：便利なので使いましょう">結論：便利なので使いましょう</h2>
<p>というわけで画像もなくずらずらと使い方を書いてみました。本当にstraightforwardなのでとくに説明することもないですね。インストールもないし。ご存知なかった方はぜひぜひ使い倒してみてください。ではでは。</p>
<h2 id="ところで関係ないけど">ところで関係ないけど</h2>
<p>Emacs 24.5で <code>;;;###tramp-autoload</code> にバグがあるような気がするのですがHEADで再現しないのでどこかに報告したほうがいいのかどうなのか分からずにいる。具体的には</p>
<x-script src="https://gist.github.com/kissge/a9f1c59959181856280f.js"></x-script><p>を使って</p>
<pre><code class="language-sh">emacs -q -l init.el
</code></pre>
<p>などとして起動した後</p>
<pre><code>C-h v tramp-verbose
</code></pre>
<p>とすると設定通り変数が変更されているのが確認できるが</p>
<pre><code>C-h v tramp-use-ssh-controlmaster-options
</code></pre>
<p>とするとデフォルトの設定で上書きされている。<code>tramp-use-ssh-controlmaster-options</code> 以外にも <code>;;;###tramp-autoload</code> が指定されている変数で同様の現象が確認できる。</p>
<!-- HTML_TAG_END --></section>

    <section class="links-section svelte-1askvef"><ul class="links"><li class="link-group"><h1 class="link-group-title">この記事がリンクしているもの</h1>
      <ul class="link-group-links"><li class="link"><a sveltekit:prefetch href="/mono/%E6%97%A5%E6%9C%AC%E8%AA%9E" class="monolog-link svelte-1ytxadn empty" data-kind="tag">日本語</a>
            
            <span class="tags"></span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC" class="monolog-link svelte-1ytxadn empty" data-kind="tag">アドベントカレンダー</a>
            
            <span class="tags"></span>
            <p></p>
          </li></ul>
    </li><li class="link-group"><h1 class="link-group-title">この記事にリンクしているもの</h1>
      <ul class="link-group-links"><li class="link"><a sveltekit:prefetch href="/notes/emacs-windows-2017" class="monolog-link svelte-1ytxadn" data-kind="note">Emacs: Windowsでやっていく2017</a>
            <small title="Fri Dec 08 2017 00:00:08 GMT+0000 (Coordinated Universal Time)"><time>2017-12-08</time>
              </small>
            <span class="tags"><a sveltekit:prefetch href="/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC" class="tag svelte-o20os9" data-kind="tag">アドベントカレンダー</a>
  </span>
            <p></p>
          </li></ul>
    </li><li class="link-group"><h1 class="link-group-title">日本語にリンクしているもの</h1>
      <ul class="link-group-links"><li class="link"><a sveltekit:prefetch href="/memorandum/%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%83%96%E3%83%AB%E3%81%AA%E4%BA%8C%E5%AD%97%E7%86%9F%E8%AA%9E" class="monolog-link svelte-1ytxadn">リバーシブルな二字熟語</a>
            
            <span class="tags"><a sveltekit:prefetch href="/mono/%E5%82%99%E5%BF%98%E9%8C%B2" class="tag svelte-o20os9" data-kind="tag">備忘録</a>
  </span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/notes/how-do-japanese-type" class="monolog-link svelte-1ytxadn" data-kind="note">How do Japanese type?</a>
            <small title="Sun May 29 2022 01:00:00 GMT+0000 (Coordinated Universal Time)"><time>2022-05-29</time>
              </small>
            <span class="tags"></span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/notes/cldr" class="monolog-link svelte-1ytxadn" data-kind="note">ja-JP-u-ca-japaneseって何？ UnicodeのCLDRを読んでみよう（あるいは、JavaScriptで和暦を得る簡単なテクについて）</a>
            <small title="Sat Feb 19 2022 02:41:00 GMT+0000 (Coordinated Universal Time)"><time>2022-02-19</time>
              </small>
            <span class="tags"><a sveltekit:prefetch href="/mono/Unicode" class="tag svelte-o20os9" data-kind="tag">Unicode</a>
  </span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/notes/emacs-windows-2017" class="monolog-link svelte-1ytxadn" data-kind="note">Emacs: Windowsでやっていく2017</a>
            <small title="Fri Dec 08 2017 00:00:08 GMT+0000 (Coordinated Universal Time)"><time>2017-12-08</time>
              </small>
            <span class="tags"><a sveltekit:prefetch href="/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC" class="tag svelte-o20os9" data-kind="tag">アドベントカレンダー</a>
  </span>
            <p></p>
          </li></ul>
    </li><li class="link-group"><h1 class="link-group-title">アドベントカレンダーにリンクしているもの</h1>
      <ul class="link-group-links"><li class="link"><a sveltekit:prefetch href="/notes/pdf-publisher-and-me" class="monolog-link svelte-1ytxadn" data-kind="note">PDFと、出版社と、私</a>
            <small title="Thu Dec 23 2021 05:00:00 GMT+0000 (Coordinated Universal Time)"><time>2021-12-23</time>
              </small>
            <span class="tags"><a sveltekit:prefetch href="/mono/LegalTech" class="tag svelte-o20os9" data-kind="tag">LegalTech</a>
  </span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/notes/legalscape-tech-stack" class="monolog-link svelte-1ytxadn" data-kind="note">リーガルリサーチシステム「Legalscape」の技術スタック2021</a>
            <small title="Thu Dec 02 2021 00:00:00 GMT+0000 (Coordinated Universal Time)"><time>2021-12-02</time>
              </small>
            <span class="tags"></span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/notes/crowdfunding-vue" class="monolog-link svelte-1ytxadn" data-kind="note">来年こそは届いてほしいスマートグラス「Vue」</a>
            <small title="Thu Dec 13 2018 00:17:07 GMT+0000 (Coordinated Universal Time)"><time>2018-12-13</time>
              </small>
            <span class="tags"></span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/notes/emacs-windows-2017" class="monolog-link svelte-1ytxadn" data-kind="note">Emacs: Windowsでやっていく2017</a>
            <small title="Fri Dec 08 2017 00:00:08 GMT+0000 (Coordinated Universal Time)"><time>2017-12-08</time>
              </small>
            <span class="tags"></span>
            <p></p>
          </li><li class="link"><a sveltekit:prefetch href="/notes/foreign-regexp-el" class="monolog-link svelte-1ytxadn" data-kind="note">Emacs: re-builder + foreign-regexp.elでたのしい正規表現</a>
            <small title="Fri Dec 19 2014 23:30:53 GMT+0000 (Coordinated Universal Time)"><time>2014-12-20</time>
              </small>
            <span class="tags"></span>
            <p></p>
          </li></ul>
    </li></ul></section>

    <section class="mentions svelte-19gm1ik"><section class="reaction svelte-19gm1ik"><a href="https://twitter.com/intent/tweet?url=" class="svelte-19gm1ik" style="background-image: url(/_app/immutable/assets/message-circle-c0b45d48.svg); color: #3579d1;"><small class="svelte-19gm1ik">Twitterで</small>
        <span class="svelte-19gm1ik">コメントする</span></a></section>

  <h1 class="svelte-19gm1ik">Mentions</h1>
  <ol reversed class="svelte-19gm1ik loading"></ol>
</section></article>
</main>

<footer class="global-footer">Built with <a href="https://github.com/kissge/monolog">monolog</a></footer>

<!-- HTML_TAG_START --><style> .viewer-header h1::before,.tag::before,.monolog-link::before{content:'🌐'}[data-kind="note"] .viewer-header h1::before,.tag[data-kind="note"]::before,.monolog-link[data-kind="note"]::before{content:'🖋'}[data-kind="tag"] .viewer-header h1::before,.tag[data-kind="tag"]::before,.monolog-link[data-kind="tag"]::before{content:'#'}[data-kind="location"] .viewer-header h1::before,.tag[data-kind="location"]::before,.monolog-link[data-kind="location"]::before{content:'📍'}[data-kind="creator"] .viewer-header h1::before,.tag[data-kind="creator"]::before,.monolog-link[data-kind="creator"]::before{content:'🧍'}[data-kind="旅行"] .viewer-header h1::before,.tag[data-kind="旅行"]::before,.monolog-link[data-kind="旅行"]::before{content:'✈️'}[data-kind="ライブ"] .viewer-header h1::before,.tag[data-kind="ライブ"]::before,.monolog-link[data-kind="ライブ"]::before{content:'🎵'}[data-kind="ハンバーガー店"] .viewer-header h1::before,.tag[data-kind="ハンバーガー店"]::before,.monolog-link[data-kind="ハンバーガー店"]::before{content:'🍔'}[data-kind="ミュージシャン"] .viewer-header h1::before,.tag[data-kind="ミュージシャン"]::before,.monolog-link[data-kind="ミュージシャン"]::before{content:'🎸'}</style><!-- HTML_TAG_END -->


		<script type="module" data-sveltekit-hydrate="1yo9ldm">
		import { start } from "/_app/immutable/start-ef4dd391.js";
		start({
			target: document.querySelector('[data-sveltekit-hydrate="1yo9ldm"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "always",
			hydrate: {
				status: 200,
				error: null,
				nodes: [0, 2],
				params: {entity:"notes\u002Ftramp-mode\u002F"},
				routeId: "[...entity]"
			}
		});
	</script><script type="application/json" sveltekit:data-type="props">{"entity":{"name":"Emacs: まだターミナルで消耗してるの？","nameSegmented":["Emacs: まだ","ターミナルで","消耗してるの？"],"kind":"note","urlPath":"/notes/tramp-mode","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/tramp-mode.md","lastModified":"2022-06-11T07:33:39.000Z","attributes":{"from":"wordpress","title":"Emacs: まだターミナルで消耗してるの？","date":"2015-12-04T23:00:02.000Z","tags":["アドベントカレンダー"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"}],"body":"\u003Cp>この記事は\u003Ca href=\"http://qiita.com/advent-calendar/2015/emacs\">Emacs Advent Calendar 2015\u003C/a>の第5日目の記事として書かれました。第4日目は\u003Ca href=\"http://qiita.com/niku\">niku\u003C/a>さんによる記事の予定です。「org-babelについて書くかも」とのこと。第6日目は\u003Ca href=\"http://qiita.com/takaxp\">takaxp\u003C/a>さんによる記事の予定です。「何も書かずに2015年を終えられると思うほど堕落してはおらんっ」とのこと。\u003C/p>\n\u003C!--more-->\n\n\u003Ch2 id=\"ずいぶんとダサい開発をしているのね\">ずいぶんとダサい開発をしているのね\u003C/h2>\n\u003Cp>所属柄私の周りには少なくないEmacsユーザがいるのに、だれも \u003Ccode>tramp-mode\u003C/code> のことを知らないようでここ数ヶ月で2、3回同じことを説明するはめになったのでついでにここにも書くことにします。初心者に説明する意図での記述なのでコアなユーザの方には物足りないものかもしれません。\u003C/p>\n\u003Cp>さてみなさん普段GUIでEmacs使ってますか？\n使ってるのにときどきCUIを使わざるを得ないという状況に陥りますか？\nだいたいそういうケースは次のどちらかのパターンなのではないでしょうか。\u003C/p>\n\u003Col>\n\u003Cli>rootとしてファイルを開きたい（\u003Ccode>sudo\u003C/code> したい）とき\u003C/li>\n\u003Cli>ssh先のサーバ上でファイルを編集したいとき\u003C/li>\n\u003C/ol>\n\u003Cp>まあどちらもままあることです。2. に至っては「手元（ローカル）のEmacsとで設定ファイルが共有されていないから不便／共有するのが面倒」なんてことになってませんか？よくないやつですね。こういった問題を全て解決する簡単な方法のひとつが \u003Ccode>tramp-mode\u003C/code> です。\u003C/p>\n\u003Ch2 id=\"tramp-mode-で-sudo-してみる\">\u003Ccode>tramp-mode\u003C/code> で \u003Ccode>sudo\u003C/code> してみる\u003C/h2>\n\u003Cp>というわけで幾つかの使用例を見てみましょう。\u003Ccode>tramp-mode\u003C/code> はいま普通にEmacsを使っているユーザの大半の環境では最初から入っているかと思いますが、22.1より古いバージョンを使っている方が万が一いればEmacsをバージョンアップしてください。\u003C/p>\n\u003Cp>たとえば \u003Ccode>/etc/httpd/conf/httpd.conf\u003C/code> を開くとき、普通に開くとread-onlyとなり\u003C/p>\n\u003Cpre>\u003Ccode>Note: file is write protected\n\u003C/code>\u003C/pre>\n\u003Cp>と怒られるかと思います。これをrootとして開くには次のように\u003C/p>\n\u003Cpre>\u003Ccode>C-x C-f /sudo::/etc/httpd/conf/httpd.conf\n\u003C/code>\u003C/pre>\n\u003Cp>と \u003Ccode>find-file\u003C/code> に渡すパスの前に \u003Ccode>/sudo::\u003C/code> を追加するだけです。\u003Ccode>/su::\u003C/code> なら更に短縮できますね（挙動の違いは見てお分かりの通りです）。\u003C/p>\n\u003Ch2 id=\"tramp-mode-でssh先のサーバ上のファイルを編集してみる\">\u003Ccode>tramp-mode\u003C/code> でssh先のサーバ上のファイルを編集してみる\u003C/h2>\n\u003Cp>同じように、sshで接続できる外部サーバ上のファイルを開くには\u003C/p>\n\u003Cpre>\u003Ccode>C-x C-f /user@example.com:path/to/file\n\u003C/code>\u003C/pre>\n\u003Cp>です。ユーザ名とホスト名のあとは \u003Ccode>/\u003C/code> からはじめてフルパスを書くか、あるいは \u003Ccode>$HOME\u003C/code> からの相対パスを書くことが出来ます。実はこの記法は接続メソッドが自動でデフォルトで補われているもので、次の略記です。\u003C/p>\n\u003Cpre>\u003Ccode>/scp:user@example.com:path/to/file\n\u003C/code>\u003C/pre>\n\u003Cp>この \u003Ccode>scp\u003C/code> はいくつかある接続メソッドの一つです。メソッドを省略した場合は \u003Ccode>tramp-default-method\u003C/code> という変数の内容を見て決定されます。Emacs 24.3くらいまではこの変数のデフォルト値は \u003Ccode>scpc\u003C/code> だったような気がしますが廃止されました。\u003Ccode>scp\u003C/code> では基本的にホストとの接続はsshで行われ、ファイルの転送はscpで行われます。頻繁にファイルを開いたり閉じたりする場合にはscpのオーバヘッドが効いて、すべてsshで行う \u003Ccode>ssh\u003C/code> というメソッドのほうが速い場合もあります。\u003C/p>\n\u003Cp>ちなみに \u003Ccode>shell\u003C/code> も開けるし \u003Ccode>compile\u003C/code> だって出来ます。便利〜\u003C/p>\n\u003Ch2 id=\"ssh先からsshした先のファイルを編集する\">ssh先からsshした先のファイルを編集する\u003C/h2>\n\u003Cp>何だか\u003Ca href=\"/mono/%E6%97%A5%E6%9C%AC%E8%AA%9E\" class=\"monolog-link\" sveltekit:prefetch title=\"日本語\">日本語\u003C/a>が怪しいですが、いわゆる踏み台サーバみたいなものが中間にある状況です。これもままあるかとおもいます。もっともよい解決策はsshのconfigに \u003Ccode>ProxyCommand\u003C/code> を設定することでこのホップを自動で行わせることでしょう。たとえば \u003Ccode>example1.com\u003C/code> に繋ぐために \u003Ccode>example2.com\u003C/code> に一旦繋ぐ必要がある場合には、sshのconfig（たとえば \u003Ccode>~/.ssh/config\u003C/code> ）に\u003C/p>\n\u003Cpre>\u003Ccode>Host example1\n    HostName example1.com\n    ProxyCommand ssh example2 -W %h:%p 2&gt; /dev/null\nHost example2\n    HostName example2.com\n\u003C/code>\u003C/pre>\n\u003Cp>などと書くことでターミナルから\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">$ ssh example1\n\u003C/code>\u003C/pre>\n\u003Cp>だけで一発で目的のホストに繋ぐことが出来ます。この設定をしているときにはEmacsで\u003C/p>\n\u003Cpre>\u003Ccode>C-x C-f /example1:path/to/file\n\u003C/code>\u003C/pre>\n\u003Cp>とするとこのホップを裏で自動で行ってもらうことが出来ます。\u003C/p>\n\u003Cp>もう一つの方法は \u003Ccode>tramp-mode\u003C/code> で明示的にホップさせることです。おそらくいま使われているような最近のバージョン (24.3以降) ですと\u003C/p>\n\u003Cpre>\u003Ccode>C-x C-f /ssh:example2.com|ssh:example1.com:path/to/file\n\u003C/code>\u003C/pre>\n\u003Cp>で同じことが出来るかと思います。\u003C/p>\n\u003Ch2 id=\"ssh先でsudoする\">ssh先でsudoする\u003C/h2>\n\u003Cp>ここまで読むともう次に何をするかはおわかりでしょう。実際ssh先でroot権限でファイルを読むこともよくありますよね。\u003C/p>\n\u003Cpre>\u003Ccode>C-x C-f /ssh:user@example.com|sudo:example.com:/etc/httpd/conf/httpd.conf\n\u003C/code>\u003C/pre>\n\u003Ch2 id=\"陥りがちなトラップ\">陥りがちなトラップ\u003C/h2>\n\u003Cp>いくつか注意点のようなもの。\u003C/p>\n\u003Cp>ホップして踏み台越しの接続をするときに \u003Ccode>/ssh:foo|sudo:foo:/etc/...\u003C/code> のように \u003Ccode>ssh\u003C/code> を省略することは出来ません。上述のようにこの場合デフォルトの \u003Ccode>scp\u003C/code> が使用されますが、このメソッドはホップに対応していません。また、\u003Ccode>sudo::\u003C/code> とホストを省略する記法もここでは使えません。\u003C/p>\n\u003Cp>また、 \u003Ccode>tramp-mode\u003C/code> で繋ぐ先のホストのログインシェルがzshの場合、接続がうまくいかない場合があります。よく見受けられる対処法（私も使っています）は、 \u003Ccode>.zshrc\u003C/code> の1行目にEmacsからの接続を識別する場合分けを追加することのようです。\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">[[ \u003Cspan class=\"hljs-variable\">$TERM\u003C/span> == \u003Cspan class=\"hljs-string\">&quot;dumb&quot;\u003C/span> ]] &amp;&amp; \u003Cspan class=\"hljs-built_in\">unsetopt\u003C/span> \u003Cspan class=\"hljs-built_in\">zle\u003C/span> &amp;&amp; PS1=\u003Cspan class=\"hljs-string\">&#x27;$ &#x27;\u003C/span> &amp;&amp; \u003Cspan class=\"hljs-built_in\">return\u003C/span>\n\u003C/code>\u003C/pre>\n\u003Cp>もう一点上級者向けっぽいことを書くと、システムグローバルな設定のままControlMasterを使うようにカスタマイズする場合、Emacsで最初にshared connectionを開いてからターミナルなどでsshセッションを開き、Emacsを終了するとターミナルの方も同時に落ちる、というようなことになる場合があります。このへんは好き好きというか、一般にどうするのがよいのか不明です。カスタマイズしなければ関係ないですが。\u003C/p>\n\u003Ch2 id=\"結論：便利なので使いましょう\">結論：便利なので使いましょう\u003C/h2>\n\u003Cp>というわけで画像もなくずらずらと使い方を書いてみました。本当にstraightforwardなのでとくに説明することもないですね。インストールもないし。ご存知なかった方はぜひぜひ使い倒してみてください。ではでは。\u003C/p>\n\u003Ch2 id=\"ところで関係ないけど\">ところで関係ないけど\u003C/h2>\n\u003Cp>Emacs 24.5で \u003Ccode>;;;###tramp-autoload\u003C/code> にバグがあるような気がするのですがHEADで再現しないのでどこかに報告したほうがいいのかどうなのか分からずにいる。具体的には\u003C/p>\n\u003Cx-script src=\"https://gist.github.com/kissge/a9f1c59959181856280f.js\">\u003C/x-script>\u003Cp>を使って\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-sh\">emacs -q -l init.el\n\u003C/code>\u003C/pre>\n\u003Cp>などとして起動した後\u003C/p>\n\u003Cpre>\u003Ccode>C-h v tramp-verbose\n\u003C/code>\u003C/pre>\n\u003Cp>とすると設定通り変数が変更されているのが確認できるが\u003C/p>\n\u003Cpre>\u003Ccode>C-h v tramp-use-ssh-controlmaster-options\n\u003C/code>\u003C/pre>\n\u003Cp>とするとデフォルトの設定で上書きされている。\u003Ccode>tramp-use-ssh-controlmaster-options\u003C/code> 以外にも \u003Ccode>;;;###tramp-autoload\u003C/code> が指定されている変数で同様の現象が確認できる。\u003C/p>\n","headline":"この記事はEmacs Advent Calendar 2015の第5日目の記事として書かれました。第4日目はnikuさんによる記事の予定です。「org-babelについて書くかも」とのこと。第6日目はtakaxpさんによる記事の予定です。「何も書かずに2015年を終えられると思うほど堕落してはおらんっ」とのこと。ずいぶんとダサい開発をしているのね所属柄私の周りには少なくないEmacsユーザがいるのに、だれも tramp-mode のことを知らないようでここ数ヶ月で2、3回同じことを説明するはめになったのでついでにここにも書くことにします。初心者に説明する意図での記述なのでコアなユーザの方には物足りないものかもしれません。さてみなさん普段GUIでEmacs使ってますか？使ってるのにときどきCUIを使わざるを得ないという状況に陥りますか？だいたいそういうケースは次のどちらかのパターンなのではないでしょうか。rootとしてファイルを開きたい（sudo したい）ときssh先のサーバ上でファイルを編集したいときまあどちらもままあることです。2. に至っては「手元（ローカル）のEmacsとで設定ファイルが共有されていない","links":{"to":{"urlPath":"/notes/tramp-mode","entities":[{"name":"日本語","nameSegmented":["日本語"],"kind":"tag","urlPath":"/mono/%E6%97%A5%E6%9C%AC%E8%AA%9E","tags":[],"isEmpty":true},{"name":"アドベントカレンダー","nameSegmented":["アドベントカレンダー"],"kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC","tags":[],"isEmpty":true}]},"from":{"urlPath":"/notes/tramp-mode","entities":[{"name":"Emacs: Windowsでやっていく2017","nameSegmented":["Emacs: ","Windowsで","やっていく","2017"],"kind":"note","urlPath":"/notes/emacs-windows-2017","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/emacs-windows-2017.md","lastModified":"2022-07-02T05:00:46.000Z","attributes":{"from":"wordpress","title":"Emacs: Windowsでやっていく2017","date":"2017-12-08T00:00:08.000Z","tags":["アドベントカレンダー"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"}],"isEmpty":false}]},"kind":{"urlPath":"/notes/tramp-mode","entities":[]},"one_hop_日本語":{"urlPath":"/mono/%E6%97%A5%E6%9C%AC%E8%AA%9E","entities":[{"name":"リバーシブルな二字熟語","nameSegmented":["リバーシブルな","二字熟語"],"urlPath":"/memorandum/%E3%83%AA%E3%83%90%E3%83%BC%E3%82%B7%E3%83%96%E3%83%AB%E3%81%AA%E4%BA%8C%E5%AD%97%E7%86%9F%E8%AA%9E","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/memorandum/リバーシブルな二字熟語.md","lastModified":"2022-06-12T03:43:05.000Z","attributes":{"tags":["備忘録","日本語"]},"tags":[{"name":"備忘録","kind":"tag","urlPath":"/mono/%E5%82%99%E5%BF%98%E9%8C%B2"},{"name":"日本語","kind":"tag","urlPath":"/mono/%E6%97%A5%E6%9C%AC%E8%AA%9E"}],"isEmpty":false},{"name":"How do Japanese type?","nameSegmented":["How"," do ","Japanese"," type?"],"kind":"note","urlPath":"/notes/how-do-japanese-type","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/how-do-japanese-type.md","lastModified":"2022-06-11T11:32:30.000Z","attributes":{"title":"How do Japanese type?","date":"2022-05-29T01:00:00.000Z","lang":"en","tags":["日本語"]},"tags":[{"name":"日本語","kind":"tag","urlPath":"/mono/%E6%97%A5%E6%9C%AC%E8%AA%9E"}],"isEmpty":false},{"name":"ja-JP-u-ca-japaneseって何？ UnicodeのCLDRを読んでみよう（あるいは、JavaScriptで和暦を得る簡単なテクについて）","nameSegmented":["ja-","JP","-u","-ca-","japaneseって","何？"," Unicodeの","CLDRを","読んでみよう","（あるいは、","JavaScriptで","和暦を","得る","簡単な","テクに","ついて）"],"kind":"note","urlPath":"/notes/cldr","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/cldr.md","lastModified":"2022-06-11T11:32:20.000Z","attributes":{"title":"ja-JP-u-ca-japaneseって何？ UnicodeのCLDRを読んでみよう（あるいは、JavaScriptで和暦を得る簡単なテクについて）","date":"2022-02-19T02:41:00.000Z","tags":["Unicode"]},"tags":[{"name":"Unicode","kind":"tag","urlPath":"/mono/Unicode"}],"isEmpty":false},{"name":"Emacs: Windowsでやっていく2017","nameSegmented":["Emacs: ","Windowsで","やっていく","2017"],"kind":"note","urlPath":"/notes/emacs-windows-2017","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/emacs-windows-2017.md","lastModified":"2022-07-02T05:00:46.000Z","attributes":{"from":"wordpress","title":"Emacs: Windowsでやっていく2017","date":"2017-12-08T00:00:08.000Z","tags":["アドベントカレンダー"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"}],"isEmpty":false}]},"one_hop_アドベントカレンダー":{"urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC","entities":[{"name":"PDFと、出版社と、私","nameSegmented":["PDFと、","出版社と、","私"],"kind":"note","urlPath":"/notes/pdf-publisher-and-me","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/pdf-publisher-and-me.md","lastModified":"2022-09-04T05:58:48.000Z","attributes":{"title":"PDFと、出版社と、私","date":"2021-12-23T05:00:00.000Z","tags":["アドベントカレンダー","LegalTech"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"},{"name":"LegalTech","kind":"tag","urlPath":"/mono/LegalTech"}],"isEmpty":false},{"name":"リーガルリサーチシステム「Legalscape」の技術スタック2021","nameSegmented":["リーガルリサーチシステム","「Legalscape」の","技術スタック","2021"],"kind":"note","urlPath":"/notes/legalscape-tech-stack","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/legalscape-tech-stack.md","lastModified":"2022-06-11T07:33:39.000Z","attributes":{"title":"リーガルリサーチシステム「Legalscape」の技術スタック2021","date":"2021-12-02T00:00:00.000Z","tags":["アドベントカレンダー"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"}],"isEmpty":false},{"name":"来年こそは届いてほしいスマートグラス「Vue」","nameSegmented":["来年","こそは","届いて","ほしい","スマートグラス","「Vue」"],"kind":"note","urlPath":"/notes/crowdfunding-vue","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/crowdfunding-vue.md","lastModified":"2022-06-11T07:34:19.000Z","attributes":{"from":"wordpress","title":"来年こそは届いてほしいスマートグラス「Vue」","date":"2018-12-13T00:17:07.000Z","tags":["アドベントカレンダー"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"}],"isEmpty":false},{"name":"Emacs: Windowsでやっていく2017","nameSegmented":["Emacs: ","Windowsで","やっていく","2017"],"kind":"note","urlPath":"/notes/emacs-windows-2017","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/emacs-windows-2017.md","lastModified":"2022-07-02T05:00:46.000Z","attributes":{"from":"wordpress","title":"Emacs: Windowsでやっていく2017","date":"2017-12-08T00:00:08.000Z","tags":["アドベントカレンダー"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"}],"isEmpty":false},{"name":"Emacs: re-builder + foreign-regexp.elでたのしい正規表現","nameSegmented":["Emacs: ","re","-builder"," +"," foreign","-regexp.","elで","たのしい","正規表現"],"kind":"note","urlPath":"/notes/foreign-regexp-el","historyURL":"https://github.com/kissge/yo.eki.do/commits/master/notes/foreign-regexp-el.md","lastModified":"2022-06-11T07:52:23.000Z","attributes":{"from":"wordpress","title":"Emacs: re-builder + foreign-regexp.elでたのしい正規表現","date":"2014-12-19T23:30:53.000Z","tags":["アドベントカレンダー"]},"tags":[{"name":"アドベントカレンダー","kind":"tag","urlPath":"/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC"}],"isEmpty":false}]}},"isEmpty":false}}</script></div>
  </body>
</html>
