{"type":"data","nodes":[null,{"type":"data","data":[{"entity":1},{"name":2,"nameSegmented":3,"kind":7,"urlPath":8,"historyURL":9,"lastModified":10,"attributes":11,"tags":15,"body":19,"headline":20,"links":21,"isEmpty":94},"リーガルリサーチシステム「Legalscape」の技術スタック2021",[4,5,6],"リーガルリサーチシステム","「Legalscape」の","技術スタック2021","note","/notes/legalscape-tech-stack","https://github.com/kissge/yo.eki.do/commits/master/notes/legalscape-tech-stack.md",["Date","2022-06-11T07:33:39.000Z"],{"title":2,"date":12,"tags":13},["Date","2021-12-02T00:00:00.000Z"],[14],"アドベントカレンダー",[16],{"name":14,"kind":17,"urlPath":18},"tag","/mono/%E3%82%A2%E3%83%89%E3%83%99%E3%83%B3%E3%83%88%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC","\u003Cp>こんにちは。\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a> Co-Founder &amp; CTOの城戸（きど）です。この記事は\u003Ca href=\"https://qiita.com/advent-calendar/2021/legalscape\">Legalscape アドベントカレンダー 2021\u003C/a>の2日目のエントリです。\u003C/p>\n\u003Cp>今日は私たちの主力プロダクトである「\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>」を支える技術スタックについて簡単に説明し、なぜそれを選んだのかを語ることで、これを読んでいるあなたに私たちのチームについて理解を深めていただきたいと思います。\u003C/p>\n\u003Ch1 id=\"legalscapeって、何？\">\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>って、何？\u003C/h1>\n\u003Cp>\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>は、法務に携わる方々が使うリサーチシステムです。どんな製品なのかについては弊社ブログの過去の記事（\u003Ca href=\"https://note.com/legalscape/n/n673bf813e198\" class=\"monolog-external-link\" rel=\"external\">はじめまして、Legalscapeです\u003C/a>）を見ていただきたいのですが、簡単に言うとWebアプリなので、バックエンド、フロントエンドからなり、裏に検索エンジンやデータベースがあります。これらが全て\u003Cstrong>Google Cloud Platform\u003C/strong> (GCP) 上で構築されています。\u003C/p>\n\u003Cp>では、それぞれのコンポーネントについて詳しく見ていきましょう。\u003C/p>\n\u003Ch1 id=\"バックエンド\">バックエンド\u003C/h1>\n\u003Cp>\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>のAPIサーバは\u003Cstrong>\u003Ca href=\"/mono/TypeScript\" class=\"monolog-link\"  title=\"TypeScript\">TypeScript\u003C/a>\u003C/strong>で書かれています。確かにそこまでメジャーな選択肢ではありませんが、フロントエンドと型定義などを共通化できますし、\u003Ca href=\"/mono/TypeScript\" class=\"monolog-link\"  title=\"TypeScript\">TypeScript\u003C/a>の型システムは現実の問題を解くのにちょうど良くできていると感じています（ちゃんと書けばですが）。近年では\u003Ca href=\"https://github.com/frouriojs/frourio\">frourio\u003C/a>などフロントエンドとバックエンドを融合するフレームワークなども出現していますし、方向性は間違っていないのではないかなと思っています。\u003C/p>\n\u003Cp>併せて、\u003Cstrong>OpenAPI\u003C/strong>を使ったスキーマファースト開発っぽいことをしています。具体的には、\u003Ca href=\"https://github.com/cdimascio/express-openapi-validator\">express-openapi-validator\u003C/a>を使ってAPI定義と具体的な実装を繋ぎこみ、リクエストパラメータがスキーマに従っていることを自動的に検証させたり、\u003Cstrong>Jest\u003C/strong>と\u003Cstrong>ajv\u003C/strong>を組み合わせて使ってAPIレスポンスがOpenAPIドキュメントに定義されたスキーマに従っていることを検証しています。Jestは導入を検討したときから業界的に主流のテスティングフレームワークですし、ユニットテスト初心者でも比較的書きやすいような気がします。\u003C/p>\n\u003Cp>APIサーバは、GCPの\u003Cstrong>Google App Engine\u003C/strong>上で動かしています。デプロイも簡潔ですし使いやすいです。今の\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>の規模だとみんな大好きKubernetesなどを使って問題を複雑に解く必要はないと思います。\u003C/p>\n\u003Cp>全文検索エンジンには\u003Cstrong>Elasticsearch\u003C/strong>を採用しました。ひたすら試行錯誤を重ねてちょっとずつちょっとずつ最適化されてきていますが、まだまだチューニングの余地があるのだと思います。こういうの好きな人、うちに来てくれないかなー。楽しいと思うんですけど。\u003C/p>\n\u003Ch1 id=\"フロントエンド\">フロントエンド\u003C/h1>\n\u003Cp>当然、フロントエンドも\u003Ca href=\"/mono/TypeScript\" class=\"monolog-link\"  title=\"TypeScript\">TypeScript\u003C/a>で書かれています。フロントエンドフレームワークには\u003Cstrong>Nuxt.js\u003C/strong> (Vue.js) を採用しました。Vueは優れた学習曲線を持つフレームワークだと思います。パフォーマンス的にも遜色ないのではないでしょうか。\u003C/p>\n\u003Cp>通信部分はもともとそんなに多くなかったこともあり直接レポジトリ層からAxiosを呼び出したりしていましたが、前述のOpenAPIによる自動生成されたコードで徐々に置き換えています。\u003C/p>\n\u003Cp>エンジニアの数も少なくコンポーネントの種類も多くはないためそこまで重要視してはいませんが、アイコンやボタンなどの一部の共有コンポーネントは\u003Cstrong>Storybook\u003C/strong>で管理しています。サーブには\u003Cstrong>Chromatic\u003C/strong>を利用して、mainブランチが更新されるたびにCIでデプロイがされるようになっています。これまでのコンポーネントの変更が時系列で見ることができて、実際のStorybookとの行き来も自由にできるので、エンジニアでも気軽に使えて全体が把握しやすくなっています。\u003C/p>\n\u003Cp>フロントエンドは、\u003Cstrong>Firebase Hosting\u003C/strong>上でサーブしています。人手によるデプロイの場合もCDの場合もツールがきちんと整備されていて楽です。Google Cloud Storageから直接サーブすることも検討したのですが、SPAとの相性の観点でFirebase Hostingに軍配が上がりました。\u003C/p>\n\u003Ch1 id=\"dwh\">DWH\u003C/h1>\n\u003Cp>DWHとして\u003Cstrong>BigQuery\u003C/strong>を利用しています。APIサーバから\u003Cstrong>Cloud Logging\u003C/strong>を経由してログを取り込んでいます。（取り扱うデータの規模によりますが）低コストでデータウェアハウスを構築できるのはいいですね。こちらについては12/14公開予定の記事で詳しく紹介しようと思いますので、乞うご期待。\u003C/p>\n\u003Ch1 id=\"その他（開発体験、運用）\">その他（開発体験、運用）\u003C/h1>\n\u003Cp>先述の通り\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>はGCP上で稼働していますが、VMやLBなど各種リソースをできる限り\u003Cstrong>Terraform\u003C/strong>のコンフィギュレーションで表現しています。現状のリソース構成がどのようになっているかを把握しやすいですし、変更するときもレビューしやすいです。こちらについても12/9公開予定の記事で詳しく紹介しようと思います。\u003C/p>\n\u003Cp>CI/CDは\u003Cstrong>GitHub Actions\u003C/strong>を活用しています。色々なactionsを組み合わせることでワークフローを作れるのが便利です。社内のCI/CD環境はかなり良く整備されていて、stageリリース、canaryリリース、productionリリースなどがストレスなく簡単に自動で行えます。\u003C/p>\n\u003Cp>システムの監視にはGCPの\u003Cstrong>Cloud Monitoring\u003C/strong>を使っています。当たり前ですが、GCPの各種サービスとの相性が良く、監視エージェントなどを導入しなくても勝手にメトリクスを収集できる強みがあります。\u003C/p>\n\u003Ch1 id=\"終わりに\">終わりに\u003C/h1>\n\u003Cp>\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>を支える技術スタックについて、駆け足ではありますが紹介していきました。他にも私たちはこの国の裁判のあり方を変える民事判決のオープンデータ化のプロジェクト（\u003Ca href=\"https://note.com/legalscape/n/n4dfbed9f1b38\" class=\"monolog-external-link\" rel=\"external\">「民事判決のオープンデータ化」とは何で、なぜ必要で、なぜ私たちが関わっているのか\u003C/a>）のための実験環境だったり、また\u003Ca href=\"/mono/Legalscape\" class=\"monolog-link\"  title=\"Legalscape\">Legalscape\u003C/a>に掲載されるデータに対するたくさんの（！）アノテーションツールだったり、色々なシステムを抱えていますが、全部は語りきれません。\u003C/p>\n\u003Cp>この記事を読んで私たちのチームでの開発に興味が湧いた方や、もっと詳しく聞きたい！　という方は、ぜひ\u003Ca href=\"https://legalscape.notion.site/09aeb478072946c18249495b8fb63fcd\">採用情報\u003C/a>をご覧ください！　カジュアル面談からでも大丈夫ですので、気軽にご連絡いただけるのをお待ちしております。\u003C/p>\n","こんにちは。Legalscape Co-Founder &amp; CTOの城戸（きど）です。この記事はLegalscape アドベントカレンダー 2021の2日目のエントリです。今日は私たちの主力プロダクトである「Legalscape」を支える技術スタックについて簡単に説明し、なぜそれを選んだのかを語ることで、これを読んでいるあなたに私たちのチームについて理解を深めていただきたいと思います。Legalscapeって、何？Legalscapeは、法務に携わる方々が使うリサーチシステムです。どんな製品なのかについては弊社ブログの過去の記事（はじめまして、Legalscapeです）を見ていただきたいのですが、簡単に言うとWebアプリなので、バックエンド、フロントエンドからなり、裏に検索エンジンやデータベースがあります。これらが全てGoogle Cloud Platform (GCP) 上で構築されています。では、それぞれのコンポーネントについて詳しく見ていきましょう。バックエンドLegalscapeのAPIサーバはTypeScriptで書かれています。確かにそこまでメジャーな選択肢ではありませんが、フロントエンド",{"to":22,"one_hop_「民事判決のオープンデータ化」とは何で、なぜ必要で、なぜ私たちが関わっているのか":70,"one_hop_TypeScript":72,"one_hop_アドベントカレンダー":95,"one_hop_Legalscape":172},{"urlPath":8,"entities":23},[24,41,53,58,61],{"name":25,"nameSegmented":26,"kind":7,"urlPath":34,"historyURL":35,"lastModified":36,"attributes":37,"tags":40,"isEmpty":39},"「民事判決のオープンデータ化」とは何で、なぜ必要で、なぜ私たちが関わっているのか",[27,28,29,30,31,30,32,33],"「民事判決の","オープンデータ化」とは","何で、","なぜ","必要で、","私たちが","関わっているのか","https://note.com/legalscape/n/n4dfbed9f1b38","https://github.com/kissge/yo.eki.do/commits/master/notes/legalscape-kamei.md",["Date","2022-07-02T09:52:44.000Z"],{"title":25,"date":38,"pinned":39,"external":34},["Date","2020-06-20T02:56:20.000Z"],true,[],{"name":42,"nameSegmented":43,"kind":7,"urlPath":47,"historyURL":48,"lastModified":49,"attributes":50,"tags":52,"isEmpty":39},"はじめまして、Legalscapeです",[44,45,46],"は","じめまして、","Legalscapeです","https://note.com/legalscape/n/n673bf813e198","https://github.com/kissge/yo.eki.do/commits/master/notes/legalscape-first.md",["Date","2022-07-02T09:52:44.000Z"],{"title":42,"date":51,"pinned":39,"external":47},["Date","2020-04-03T02:11:54.000Z"],[],{"name":54,"nameSegmented":55,"kind":17,"urlPath":56,"tags":57,"isEmpty":39},"TypeScript",[54],"/mono/TypeScript",[],{"name":14,"nameSegmented":59,"kind":17,"urlPath":18,"tags":60,"isEmpty":39},[14],[],{"name":62,"nameSegmented":63,"kind":64,"urlPath":65,"historyURL":66,"lastModified":67,"attributes":68,"tags":69,"isEmpty":39},"Legalscape",[62],"組織","/mono/Legalscape","https://github.com/kissge/yo.eki.do/commits/master/mono/組織/Legalscape.md",["Date","2024-06-01T16:59:04.000Z"],{},[],{"urlPath":34,"entities":71},[],{"urlPath":56,"entities":73},[74],{"name":75,"nameSegmented":76,"kind":77,"urlPath":78,"historyURL":79,"lastModified":80,"attributes":81,"tags":88,"isEmpty":94},"monolog",[75],"ソフトウェア","/mono/monolog","https://github.com/kissge/yo.eki.do/commits/master/mono/ソフトウェア/monolog.md",["Date","2022-12-03T14:51:29.000Z"],{"definition":82,"date":83,"url":84,"tags":85},"「もの」のログを実現する、あなたが今見ているこのWebサイトを構築したソフトウェア",["Date","2020-12-27T02:47:33.000Z"],"https://github.com/kissge/monolog",[86,87,54],"開発したもの","Svelte",[89,91,93],{"name":86,"kind":17,"urlPath":90},"/mono/%E9%96%8B%E7%99%BA%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE",{"name":87,"kind":17,"urlPath":92},"/mono/Svelte",{"name":54,"kind":17,"urlPath":56},false,{"urlPath":18,"entities":96},[97,114,130,144,158],{"name":98,"nameSegmented":99,"kind":7,"urlPath":103,"historyURL":104,"lastModified":105,"attributes":106,"tags":110,"isEmpty":94},"PDFと、出版社と、私",[100,101,102],"PDFと、","出版社と、","私","/notes/pdf-publisher-and-me","https://github.com/kissge/yo.eki.do/commits/master/notes/pdf-publisher-and-me.md",["Date","2022-09-04T05:58:48.000Z"],{"title":98,"date":107,"tags":108},["Date","2021-12-23T05:00:00.000Z"],[14,109],"LegalTech",[111,112],{"name":14,"kind":17,"urlPath":18},{"name":109,"kind":17,"urlPath":113},"/mono/LegalTech",{"name":115,"nameSegmented":116,"kind":7,"urlPath":121,"historyURL":122,"lastModified":123,"attributes":124,"tags":128,"isEmpty":94},"来年こそは届いてほしいスマートグラス「Vue」",[117,118,119,120],"来年こそは","届いて","ほしい","スマートグラス「Vue」","/notes/crowdfunding-vue","https://github.com/kissge/yo.eki.do/commits/master/notes/crowdfunding-vue.md",["Date","2022-06-11T07:34:19.000Z"],{"from":125,"title":115,"date":126,"tags":127},"wordpress",["Date","2018-12-13T00:17:07.000Z"],[14],[129],{"name":14,"kind":17,"urlPath":18},{"name":131,"nameSegmented":132,"kind":7,"urlPath":136,"historyURL":137,"lastModified":138,"attributes":139,"tags":142,"isEmpty":94},"Emacs: Windowsでやっていく2017",[133,134,135],"Emacs: Windowsで","やっていく","2017","/notes/emacs-windows-2017","https://github.com/kissge/yo.eki.do/commits/master/notes/emacs-windows-2017.md",["Date","2022-07-02T05:00:46.000Z"],{"from":125,"title":131,"date":140,"tags":141},["Date","2017-12-08T00:00:08.000Z"],[14],[143],{"name":14,"kind":17,"urlPath":18},{"name":145,"nameSegmented":146,"kind":7,"urlPath":150,"historyURL":151,"lastModified":152,"attributes":153,"tags":156,"isEmpty":94},"Emacs: まだターミナルで消耗してるの？",[147,148,149],"Emacs: まだ","ターミナルで","消耗してるの？","/notes/tramp-mode","https://github.com/kissge/yo.eki.do/commits/master/notes/tramp-mode.md",["Date","2022-06-11T07:33:39.000Z"],{"from":125,"title":145,"date":154,"tags":155},["Date","2015-12-04T23:00:02.000Z"],[14],[157],{"name":14,"kind":17,"urlPath":18},{"name":159,"nameSegmented":160,"kind":7,"urlPath":164,"historyURL":165,"lastModified":166,"attributes":167,"tags":170,"isEmpty":94},"Emacs: re-builder + foreign-regexp.elでたのしい正規表現",[161,162,163],"Emacs: re-builder + foreign-regexp.elで","たのしい","正規表現","/notes/foreign-regexp-el","https://github.com/kissge/yo.eki.do/commits/master/notes/foreign-regexp-el.md",["Date","2022-06-11T07:52:23.000Z"],{"from":125,"title":159,"date":168,"tags":169},["Date","2014-12-19T23:30:53.000Z"],[14],[171],{"name":14,"kind":17,"urlPath":18},{"urlPath":65,"entities":173},[174,186,201],{"name":175,"nameSegmented":176,"kind":7,"urlPath":179,"historyURL":180,"lastModified":181,"attributes":182,"tags":185,"isEmpty":94},"VAIO SX12 ALL BLACK EDITIONを買った",[177,178],"VAIO SX12 ALL BLACK EDITIONを","買った","/notes/vaio-sx12","https://github.com/kissge/yo.eki.do/commits/master/notes/vaio-sx12.md",["Date","2022-12-03T14:52:44.000Z"],{"title":175,"date":183,"header":184},["Date","2022-12-03T14:01:38.000Z"],"https://vaio.com/products/allblack_sx12/images/img_main.png",[],{"name":187,"nameSegmented":188,"kind":7,"urlPath":189,"historyURL":190,"lastModified":191,"attributes":192,"tags":197,"isEmpty":94},"Introduction to Legal NLP",[187],"/notes/lnlp","https://github.com/kissge/yo.eki.do/commits/master/notes/lnlp.md",["Date","2023-03-04T14:34:01.000Z"],{"title":187,"date":193,"lang":194,"slides":39,"tags":195},["Date","2022-09-04T03:30:00.000Z"],"en",[196,109],"NLP",[198,200],{"name":196,"kind":17,"urlPath":199},"/mono/NLP",{"name":109,"kind":17,"urlPath":113},{"name":98,"nameSegmented":99,"kind":7,"urlPath":103,"historyURL":104,"lastModified":105,"attributes":106,"tags":110,"isEmpty":94}],"uses":{"url":1}}]}
