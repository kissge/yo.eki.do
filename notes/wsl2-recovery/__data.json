{"type":"data","nodes":[null,{"type":"data","data":[{"entity":1},{"name":2,"nameSegmented":3,"kind":8,"urlPath":9,"historyURL":10,"lastModified":11,"attributes":12,"tags":14,"body":15,"headline":16,"links":17,"isEmpty":20},"WSL2がCatastrophic failure Error code: Wsl/Service/E_UNEXPECTEDと言って起動しなくなった",[4,5,6,7],"WSL2が","Catastrophic failure Error code: Wsl/Service/E_UNEXPECTEDと","言って","起動しなくなった","note","/notes/wsl2-recovery","https://github.com/kissge/yo.eki.do/commits/master/notes/wsl2-recovery.md",["Date","2025-08-08T21:07:43.000Z"],{"title":2,"date":13},["Date","2025-08-08T20:38:00.000Z"],[],"\u003Cp>ググって出てくる色々な対処法を試したが駄目だったので真剣に何が起きているか調べた。\u003C/p>\n\u003Cp>まずGUIのWSL設定ユーティリティを開いてセーフモード起動を有効にしてみると一応起動した。ただ \u003Ccode>sudo\u003C/code> はModule is unknown、 \u003Ccode>systemctl\u003C/code> はexec format errorで動かない。\u003C/p>\n\u003Cp>無理やりrootでログインしてみる。\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-bash\">PS C:\\Users\\yk&gt; wsl --user root -e zsh\nwsl: SAFE MODE ENABLED - many features will be disabled\nGateau\u003Cspan class=\"hljs-comment\"># ls -lS /usr/bin\u003C/span>\ntotal 159880\n-rwxr-xr-x 1 root root   10322904 May  2 13:58  yay\n-rwxr-xr-x 1 root root    8425600 Jul 21 18:16  xgettext\n-rwxr-xr-x 1 root root    5841864 Apr 23 21:29  rsvg-convert\n\n（中略）\n\n-rwxr-xr-x 1 root root          0 Aug  2 04:56  bash\n-r-xr-xr-x 1 root root          0 Aug  2 04:56  bashbug\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  bootctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  busctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  coredumpctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  homectl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  hostnamectl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  importctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  journalctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  kernel-install\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  localectl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  loginctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  machinectl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  networkctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  oomctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  portablectl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  resolvectl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-ac-power\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-analyze\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-ask-password\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-cat\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-cgls\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-cgtop\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-creds\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-cryptenroll\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-cryptsetup\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-delta\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-detect-virt\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-dissect\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-escape\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-firstboot\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-hwdb\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-id128\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-inhibit\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-machine-id-setup\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-mount\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-notify\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-nspawn\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-path\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-repart\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-run\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-socket-activate\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-stdio-bridge\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-sysext\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-sysusers\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-tmpfiles\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-tty-ask-password-agent\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-vmspawn\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  systemd-vpick\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  timedatectl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  udevadm\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  userdbctl\n-rwxr-xr-x 1 root root          0 Aug  6 02:50  varlinkctl\n-rwxr-xr-x 1 root root          0 Aug  3 22:38  wayland-scanner\n\u003C/code>\u003C/pre>\n\u003Cp>\u003Ccode>/usr/bin\u003C/code> の中身が色々と空になっている。なんじゃこれ。\u003C/p>\n\u003Cp>とりあえず依存関係的に \u003Ccode>bash\u003C/code> が必要なので、 \u003Ccode>bash\u003C/code> を再インストールする。\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-bash\">pacman -S --overwrite \u003Cspan class=\"hljs-string\">&quot;*&quot;\u003C/span> bash\n\u003C/code>\u003C/pre>\n\u003Cp>これだけでセーフモード解除しても普通に起動するようになった。久々に冷や汗をかいた。\u003C/p>\n","ググって出てくる色々な対処法を試したが駄目だったので真剣に何が起きているか調べた。まずGUIのWSL設定ユーティリティを開いてセーフモード起動を有効にしてみると一応起動した。ただ sudo はModule is unknown、 systemctl はexec format errorで動かない。無理やりrootでログインしてみる。PS C:\\Users\\yk&gt; wsl --user root -e zsh wsl: SAFE MODE ENABLED - many features will be disabled Gateau# ls -lS /usr/bin total 159880 -rwxr-xr-x 1 root root   10322904 May  2 13:58  yay -rwxr-xr-x 1 root root    8425600 Jul 21 18:16  xgettext -rwxr-xr-x 1 root root    5841864 Apr 23 21:29  rsvg-convert （中略）-rwxr-xr-x 1 root root          0 Au",{"to":18},{"urlPath":9,"entities":19},[],false],"uses":{"url":1}}]}
