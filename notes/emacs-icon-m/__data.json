{"type":"data","nodes":[null,{"type":"data","data":[{"entity":1},{"name":2,"nameSegmented":3,"kind":7,"urlPath":8,"historyURL":9,"lastModified":10,"attributes":11,"tags":14,"body":15,"headline":16,"links":17,"isEmpty":20},"Emacs: ファイル名補完で「Icon^M」を無視する",[4,5,6],"Emacs: ファイル名補完で","「Icon^M」を","無視する","note","/notes/emacs-icon-m","https://github.com/kissge/yo.eki.do/commits/master/notes/emacs-icon-m.md",["Date","2022-04-17T12:08:43.000Z"],{"from":12,"title":2,"date":13},"wordpress",["Date","2014-12-16T22:21:21.000Z"],[],"\u003Cp>Emacsでは\u003Ccode>find-file\u003C/code>などでのファイル名補完で特定の拡張子のファイルを候補に含まないように設定できる．たとえば.xlsxファイルをEmacsで開くことは普段はあまりないだろう．\u003C/p>\n\u003C!--more-->\n\n\u003Cpre>\u003Ccode class=\"language-lisp\">(\u003Cspan class=\"hljs-name\">setq\u003C/span> completion-ignored-extensions\n      (\u003Cspan class=\"hljs-name\">append\u003C/span> completion-ignored-extensions\n              &#x27;(\u003Cspan class=\"hljs-string\">&quot;./&quot;\u003C/span> \u003Cspan class=\"hljs-string\">&quot;../&quot;\u003C/span> \u003Cspan class=\"hljs-string\">&quot;.xlsx&quot;\u003C/span>)))\n(\u003Cspan class=\"hljs-name\">defadvice\u003C/span> completion-file-name-table (\u003Cspan class=\"hljs-name\">after\u003C/span> ignoring-backups-f-n-completion activate)\n  \u003Cspan class=\"hljs-string\">&quot;filter out results when the have completion-ignored-extensions&quot;\u003C/span>\n  (\u003Cspan class=\"hljs-name\">let\u003C/span> ((\u003Cspan class=\"hljs-name\">res\u003C/span> ad-return-value))\n    (\u003Cspan class=\"hljs-name\">if\u003C/span> (\u003Cspan class=\"hljs-name\">and\u003C/span> (\u003Cspan class=\"hljs-name\">listp\u003C/span> res)\n             (\u003Cspan class=\"hljs-name\">stringp\u003C/span> (\u003Cspan class=\"hljs-name\">car\u003C/span> res))\n          (\u003Cspan class=\"hljs-name\">cdr\u003C/span> res)) \u003Cspan class=\"hljs-comment\">; length &gt; 1, don&#x27;t ignore sole match\u003C/span>\n        (\u003Cspan class=\"hljs-name\">setq\u003C/span> ad-return-value\n              (\u003Cspan class=\"hljs-name\">completion-pcm--filename-try-filter\u003C/span> res)))))\n\u003C/code>\u003C/pre>\n\u003Cp>（参考：\u003Ca href=\"http://stackoverflow.com/questions/1731634/dont-show-uninteresting-files-in-emacs-completion-window\">autocomplete - Don’t show uninteresting files in Emacs completion window - Stack Overflow\u003C/a>，Emacsのバージョンによって微妙にどこかを変えなければいけなかったような気がするけど忘れた）\u003C/p>\n\u003Cp>で，マッキントッシュというオーエスでは\u003Cstrong>油断すると\u003C/strong>「Icon\\r」（\\rは制御文字のCR, 0x0d）という名前のファイルが勝手に作られることがある（「Icon?」「Icon^M」に見える場合もあるだろう）．普段は見えないので気にならないが，\u003Cstrong>油断すると\u003C/strong>，例えばDropboxがヘマをすると見えるようになっていて，CRが含まれているせいで非常に邪魔だ．消したい．\u003C/p>\n\u003Cp>が，\u003Ccode>completion-ignored-extensions\u003C/code>にそのまま\u003Ccode>\"Icon\\r\"\u003C/code>とか\u003Ccode>\"Icon\\r\"\u003C/code>とか書いてもうまくいかない．何故ならばEmacsが自動的に\u003Ccode>\\r\u003C/code>を\u003Ccode>\\n\u003C/code>に変換してくれているからである．\u003C/p>\n\u003Cp>このことは次のようにすると確かめられる．\u003C/p>\n\u003Cpre>\u003Ccode class=\"language-lisp\">(\u003Cspan class=\"hljs-name\">car\u003C/span> (\u003Cspan class=\"hljs-name\">file-name-all-completions\u003C/span> \u003Cspan class=\"hljs-string\">&quot;Icon&quot;\u003C/span> \u003Cspan class=\"hljs-string\">&quot;~/Dropbox/&quot;\u003C/span>))\n=&gt; \u003Cspan class=\"hljs-string\">&quot;Icon\n&quot;\u003C/span>\n\n(\u003Cspan class=\"hljs-name\">string=\u003C/span> \u003Cspan class=\"hljs-string\">&quot;Icon\\n&quot;\u003C/span> (\u003Cspan class=\"hljs-name\">car\u003C/span> (\u003Cspan class=\"hljs-name\">file-name-all-completions\u003C/span> \u003Cspan class=\"hljs-string\">&quot;Icon&quot;\u003C/span> \u003Cspan class=\"hljs-string\">&quot;~/Dropbox/&quot;\u003C/span>)))\n=&gt; \u003Cspan class=\"hljs-literal\">t\u003C/span>\n\u003C/code>\u003C/pre>\n\u003Cp>（注．最後の\u003Ccode>~/Dropbox/\u003C/code>を適当にIconからファイル名が始まるファイルがIcon\\rしかないディレクトリに変える）\u003C/p>\n\u003Cp>と，いうわけで\u003Ccode>completion-ignored-extensions\u003C/code>には\u003Ccode>\"Icon\\n\"\u003C/code>を追加すればよい．\u003C/p>\n","Emacsではfind-fileなどでのファイル名補完で特定の拡張子のファイルを候補に含まないように設定できる．たとえば.xlsxファイルをEmacsで開くことは普段はあまりないだろう．(setq completion-ignored-extensions       (append completion-ignored-extensions               &#x27;(&quot;./&quot; &quot;../&quot; &quot;.xlsx&quot;)))(defadvice completion-file-name-table (after ignoring-backups-f-n-completion activate)  &quot;filter out results when the have completion-ignored-extensions&quot;  (let ((res ad-return-value))    (if (and (listp res)             (stringp (car res))          (cdr res)",{"to":18},{"urlPath":8,"entities":19},[],false],"uses":{"url":1}}]}
